"use strict";function HttpInterceptor(a){"ngInject";this.request=function(a){return a.url.indexOf("https://apis.digital.gob.cl/misc/instituciones")>-1?a:(a.withCredentials=!0,null!=localStorage.getItem("token")&&(a.headers.token=localStorage.getItem("token")),null!=localStorage.getItem("session")&&(a.headers.session=localStorage.getItem("session")),a)}}function RutHelper(){this.formatearFull=function(a,b){var c=this.quitarFormato(a),d=[c.slice(0,c.length-1),"-",c.slice(c.length-1)].join(""),e=d.split("-");return this.formatear(e[0]+e[1],e[1],b)},this.formatear=function(a,b,c){var d=String(a),e="";if(d=this.quitarFormato(d),b){var f=d.charAt(d.length-1);d=d.substring(0,d.length-1)}if(!c)for(;d.length>3;)e="."+d.substr(d.length-3)+e,d=d.substring(0,d.length-3);return e=d+e,""!=e&&b?e+="-"+f:b&&(e+=f),e},this.quitarFormato=function(a){for(var b=String(a);-1!=b.indexOf(".");)b=b.replace(".","");for(;-1!=b.indexOf("-");)b=b.replace("-","");return b},this.digitoValido=function(a){return/[0-9kK]/.test(a)},this.digitoCorrecto=function(a){var b,c=a.length;if(2>c)return!1;b=c>2?a.substring(0,c-1):a.charAt(0);var d=a.charAt(c-1);if(this.digitoValido(d),null==b||null==d)return 0;var e=this.getDigito(b);return e==d.toLowerCase()},this.getDigito=function(a){for(var b=0,c=2,d=a.length-1;d>=0;d--)b+=a.charAt(d)*c,7==c?c=2:c++;var e=b%11;return 1==e?"k":0==e?"0":11-e},this.validar=function(a){var a=this.quitarFormato(a),b=a.length;if(2>b)return!1;for(var c=0;b>c;c++)if(!this.digitoValido(a.charAt(c)))return!1;for(var d="",c=b-1,e=0;c>=0;c--,e++)d+=a.charAt(c);var f="";f+=d.charAt(0),f+="-";for(var g=0,c=1,e=2;b>c;c++,e++)3==g?(f+=".",e++,f+=d.charAt(c),g=1):(f+=d.charAt(c),g++);d="";for(var c=f.length-1,e=0;c>=0;c--,e++)d+=f.charAt(c);return!!this.digitoCorrecto(a)}}function storage(a){"ngInject";var b=function(b,c){return a.set(b,c),c},c=function(b){return a.get(b)},d=function(b){a.remove(b)},e=function(){a.clearAll()};return{set:b,get:c,del:d,clear:e}}function session(a,b,c,d,e,f,g){"ngInject";function h(a){var b="acceder";switch(a){case"citizen.activity":b="actividad";break;case"citizen.profile":b="perfil";break;case"institutional.soporte":b="institucional/soporte";break;case"institutional.request":b="institucional/solicitud-activacion";break;default:b="acceder"}localStorage.setItem("pre_url",b),g.go("citizen.login")}function i(){c.clear(),b.get("$http").removeAll(),localStorage.removeItem("token"),window.location="/"}this.user=null,this.getUser=function(){var a,b=d.defer();return(a=c.get("user-data"))?b.resolve(a):b.reject(null),b.promise},this.check=function(){var e=d.defer(),f=this;return a.check().then(function(b){return a.userInfo(b).then(function(a){return a.rut=b,f.user=c.set("user-data",a)})}).then(function(b){return a.isInstitution().then(function(a){b.instutition=a,e.resolve(c.set("user-data",b))})["catch"](function(){e.resolve(b)})})["catch"](function(){c.clear(),b.get("$http").removeAll(),f.user=null,localStorage.removeItem("token"),e.resolve(null)}),e.promise},this.login=function(a){a&&c.set("redirect-to",a),null===c.get("user-data")?h(a):window.location.reload()},this.logout=function(){a.logout().then(i)["catch"](i)}}function Api(a,b,c,d){"ngInject";this.number=null,this.meta=angular.element("meta[name=api-endpoint]"),this.endpoint=_.trimEnd(this.meta.attr("content"),"/"),this.endpoint_info="https://portal.claveunica.gob.cl",this.url_metrics="https://portal.claveunica.gob.cl/api/v1/front/institutions",this.URL={activate:"/codes",check:"/accounts/check",update:"/users/{number_run}",logout:"/accounts/logout",stats:"/front/users/{number_run}/logs",account:"/users/{number_run}",methods:"/users/{number_run}/recovery",recovery:"/users/{number_run}/recovery/{method}",tasks:"/front/procedures",offices:"/front/places",faqs:"/front/faq-users",request:"/front/institutions/form",credentials:"/front/institutions/form/download",charts:"/front/institutions/{institution}/charts/{id}",institution:"/accounts/check",citizendata:"/support/{number_run}",citizendataMethod:"/users/{number_run}/recovery/{method}"},a.setEndpoint(this.endpoint),this.sendUpdateEmail=function(b,c){return a.put(this.endpoint.concat("/support/"+this.parseRutNumber(b)+"/email"),{suggestedEmail:c}).then(function(a){return a.data},function(a){return a.data})},this.deleteAgent=function(b){return a["delete"](this.endpoint.concat("/support/agents/users")+"/"+b).then(function(a){return a.data.object})},this.sendNewAgent=function(b){return a.post(this.endpoint.concat("/support/agents/users"),b).then(function(a){return a.data},function(a){return a.data})},this.getAgents=function(){return a.get(this.endpoint.concat("/support/agents/users")).then(function(a){return a.data.object.agentsUsers})},this.parseRutNumber=function(a){return parseInt(a.split("-")[0].split(".").join(""))},this.getMetrics=function(){return a.get(this.url_metrics.concat("/metrics")).then(function(a){return a.data.object})},this.check=function(){return a.get(this.endpoint_info.concat("/accounts/info")).then(function(a){return a.data.object.RolUnico.numero}.bind(this))},this.authenticateUser=function(b,d){return a.post(this.endpoint_info.concat("/accounts/login"),{username:b,password:c.encode(d)}).then(function(a){return a.data})},this.sendRecoveryAccount=function(b,c){return a.post(a.url(this.URL.citizendataMethod,this.parseRutNumber(b),c)).then(function(a){return a.data})},this.getCitizenData=function(b){return a.get(a.url(this.URL.citizendata,this.parseRutNumber(b))).then(function(a){return a.data})},this.activateUser=function(b){return a.post(a.url(this.URL.activate),{numero:this.parseRutNumber(b.numero),code_activation:c.encode(b.code_activation)}).then(function(a){return a.data})},this.updateUser=function(b,c){return a.put(a.url(this.URL.update,c),b)},this.userInfo=function(b){return a.get(this.endpoint_info.concat("/accounts/info")).then(function(a){return a.data})},this.createUser=function(b,c){return a.post(a.url(this.URL.account,this.parseRutNumber(b)),c)},this.recoveryOptions=function(b){return a.get(a.url(this.URL.methods,this.parseRutNumber(b)))},this.sendRecovery=function(b,c){return a.post(a.url(this.URL.recovery,this.parseRutNumber(b),c),null)},this.getActivity=function(b){return a.get(a.url(this.URL.stats,b)).then(function(a){return a.data.object.lastLog})},this.logout=function(){return a["delete"](this.endpoint_info.concat("/accounts/logout")).then(function(a){localStorage.removeItem("token")})},this.getFaqs=function(){return a.get(a.url(this.URL.faqs),{cache:!0}).then(function(a){return a.data.object.faq})},this.getRandomTasks=function(b){return a.get(a.url(this.URL.tasks+"?limit={limit}",b))},this.checkIp=function(){var b="https://jsonip.com";a.get(b).then(function(a){})},this.getServices=function(){var c=this.URL.tasks+"?distinct=institucion",d="https://apis.digital.gob.cl/misc/instituciones/";return a.get(a.url(c),{cache:!0}).then(function(c){var e=[];return angular.forEach(c.data.object.institucion,function(b){e.push(a.get(d+b,{cache:!0})["catch"](angular.noop))}),b.all(e)}).then(function(a){var b={};return angular.forEach(a,function(a){void 0!==a&&a.data.found&&(b[a.data._source.codigo]=a.data._source)}),b})},this.getTasksByService=function(b){return null===b?this.getRandomTasks(120):a.get(a.url(this.URL.tasks+"?institucion={id}",b.codigo))},this.getRegions=function(){function c(c){var d=[];return angular.forEach(c.data.object.region,function(b){"number"!=typeof b&&d.push(a.get(f+b,{cache:!0})["catch"](angular.noop))}),b.all(d)}function d(a){var b=[];return angular.forEach(a,function(a){a.data.error||b.push(angular.extend(a.data,{index:parseInt(a.data.codigo)}))}),b}var e=this.URL.offices+"?distinct=region",f="https://apis.digital.gob.cl/dpa/regiones/";return a.get(a.url(e),{cache:!0}).then(c).then(d)},this.getCitiesCodes=function(){return a.get(a.url(this.URL.offices+"?distinct=comuna"),{cache:!0}).then(function(a){return a.data.object.comuna})},this.getCitiesByRegion=function(b,c){return a.get("https://apis.digital.gob.cl/dpa/regiones/"+b.codigo+"/comunas",{cache:!0}).then(function(a){return a.data.filter(function(a){return _.includes(c,a.codigo)})})},this.getNearOfficesByLatlng=function(c){return a.get(a.url(this.URL.offices+"?latitude={lat}&longitude={lng}&radio={r}",c.latitude,c.longitude,"3")).then(function(c){var d=[];return angular.forEach(c.data.lugares,function(b){d.push(a.get("https://apis.digital.gob.cl/misc/instituciones/"+b.institucion).then(function(a){return b.institution_name=a.data._source.nombre,b.coordinates={latitude:b.point.latitude,longitude:b.point.longitude},b})["catch"](angular.noop))}),angular.element(".office-loading-spinner").addClass("hide"),b.all(d)})},this.getOfficesByCity=function(c){return a.get(a.url(this.URL.offices+"?comuna={id}",c.codigo)).then(function(c){var d=[];return angular.forEach(c.data.object,function(b){d.push(a.get("https://apis.digital.gob.cl/misc/instituciones/"+b.institucion).then(function(a){return b.institution_name=a.data._source.nombre,b.coordinates={latitude:b.point.latitude,longitude:b.point.longitude},b})["catch"](angular.noop))}),angular.element(".office-loading-spinner").addClass("hide"),b.all(d)})},this.requestCredentials=function(b){return a.post(a.url(this.URL.request),b)},this.getCredentialsFileLink=function(){return a.url(this.URL.credentials)},this.downloadFileAjax=function(){return a.get(a.url(this.URL.credentials)).then(function(a){var b=new Blob([a.data],{type:"text/plain;charset=utf-8;"}),c=angular.element("<a></a>");return c.attr("href",window.URL.createObjectURL(b)),c.attr("download","credenciales.csv"),c[0].click(),a.data})},this.getChartsByPeriod=function(b,c,d){return a.get(a.url(this.URL.charts+"?period={period}",b,c,d)).then(function(a){return a.data})},this.getChartsByRange=function(b,c,d,e){return a.get(a.url(this.URL.charts+"?start={start}&end={end}",b,c,d,e)).then(function(a){return a.data})},this.isInstitution=function(){return a.get(this.endpoint_info.concat("/accounts/info")).then(function(a){return a.data})}}function Messages(){this.response=function(a,b){var c="";switch(a){case 1:c="Is not logged";break;case 2:c="Bad request";break;case 3:c="Internal error in process";break;case 4:c="Session deleted";break;case 5:c="Internal error";break;case 6:c="Token is missing";break;case 7:c="Token is invalid";break;case 8:c="El usuario no tiene permisos para realizar esta acción.";break;case 9:c="Service temporarily unavailable *";break;case 10:c="Usuario creado (Activación)";break;case 13:c="Info de usuario enrolado al activarse";break;case 14:c="Información de usuario (Userinfo)";break;case 15:c="Informacion del usuario actualizada (Userinfo)";break;case 16:c="Codigo de activación enviado a <b>"+b+"</b>",c+="<br><br>",c+=-1==b.search("@")?"Si el número no esta vigente puedes corregirlo en tu <a href='https://claveunica.gob.cl/perfil'>perfil</a>":"Si el mail es incorrecto o no esta vigente puedes corregirlo en tu <a href='https://claveunica.gob.cl/perfil'>perfil</a>. Si no tienes acceso, debes solicitar un nuevo código en la <a href='https://claveunica.gob.cl/oficinas' target='_blank'>oficina</a> más cercana indicando claramente la nueva dirección de correo electrónico.",c+="<br><br>",c+="Si el código llego correctamente<br><a href='https://claveunica.gob.cl/activar'>Activa tu Claveúnica</a>";break;case 17:c="Metodo de recuperacion diponible <(1,2)>  (Recovery)";break;case 18:c="OK (Auth)";break;case 19:c="La contraseña es incorrecta";break;case 20:c="Usuario Bloqueado (Auth)";break;case 21:c="El Ciudadano no cuenta con Claveúnica";break;case 22:c="El Ciudadano necesita <a href='/activar'>activar su cuenta</a>";break;case 23:c="RUN invalido";break;case 25:c="Codigo valido (Activación)";break;case 26:c="El código no es valido. Puede solicitar uno nuevo <a href='/recuperar'>aquí</a>";break;case 27:c="El código no es valido. Puede solicitar uno nuevo <a href='/recuperar'>aquí</a>";break;case 28:c="El código no es valido. Puede solicitar uno nuevo <a href='/recuperar'>aquí</a>";break;case 29:c="Codigo bloqueado";break;case 30:c="Regiones (front)";break;case 31:c="Comunas (front)";break;case 32:c="Instituciones (front)";break;case 33:c="Lugares (front)";break;case 34:c="Faq (front)";break;case 35:c="Tramites (front)";break;case 45:c="El código de activación ha sido enviado.";break;case 47:strRest="List user agent";break;case 48:strRest="Add user agent";break;case 49:strRest="Delete user agent";break;case 50:c="Usuario no existe (Activación - Obtencion de datos)";break;case 51:c="Usuario no puede ser creado, porque ya cuenta con ClaveÚnica (Totems - Crear nuevo usuario)";break;case 52:c="El parametro <> ingresado es incorrecto (Activación - Creando Usuario)";break;case 53:c="Parametro invalido (Userinfo - Modificar usuario)";break;case 54:c="Usuario no existe (Userinfo - Consultar usuario info)";break;case 55:c="Email was successful edit";break;case 56:c="Usuario no existe (Recovery)";break;case 57:c="Usuario no tiene este metodo de recuperación";break;case 70:c="No se encontró información asociada al ciudadano.",c+="<br><br>",c+="Si nunca ha solicitado un código de activación, puede hacerlo en la <a target='_blank' href='https://claveunica.gob.cl/oficinas'>oficina</a> de Ips o Registro Civil más cercana.";break;case 71:c="El Run ya existe en su listado de Agentes o es corresponde a un Administrador";break;case 72:c="Institution not found";break;case 73:c="Agents not found to delete";break;case 74:c="El Run proporcionado no cuenta con ClaveÚnica";break;case 75:c="Email has alredy edit";break;case 76:c="Wrong edit";break;default:c="Ha ocurrido un error. Por favor intente nuevamente"}return c}}function DashboardChartController(a){"ngInject";this.selected=0,this.data=[],this.filters=["Último día","Último mes","Último año"],this.keys=["DAY","MONTHLY","YEAR"],this.options={chart:{type:"lineChart",height:250,margin:{top:50,right:20,bottom:40,left:55},showLegend:!1,x:function(a){return a.label},y:function(a){return a.y},useInteractiveGuideline:!0,noData:"Aún no hay datos disponibles"}},this.changeFilter=function(b){return a.getChartsByPeriod(this.institution,this.chart,this.keys[b]).then(function(a){})},this.changeRange=function(b,c){return a.getChartsByRange(this.institution,this.chart,b,c).then(function(a){})},this.getData=function(){return a.isInstitution().then(function(a){return this.institution=a.instituticion[1],this.changeFilter(0)}.bind(this))},this.getData()}function SiteFooterController(a){"ngInject";this.hasTransclude=function(){return a.isSlotFilled("content")}}function SiteHeaderController(a,b,c){"ngInject";this.user=null,this.initialize=function(){return a.check().then(function(a){this.user=a;var d;(d=c.get("redirect-to"))&&(c.del("redirect-to"),b.go(d))}.bind(this))},this.isState=function(a){return a===b.$current.name},this.isCitizen=function(){return/^citizen/.test(b.$current.name)},this.isInstitutional=function(){return/^institutional/.test(b.$current.name)},this.hideCitizenMenu=function(){return this.user||this.isState("citizen.home")||this.isInstitutional()},this.hideInstitutionMenu=function(){return this.isCitizen()},this.goHome=function(){this.isInstitutional()&&b.go("institutional.home"),this.isCitizen()&&b.go("citizen.home")},this.initialize()}function UserFormController(a,b){"ngInject";this.fullName=null,this.password="",this.showPassword=[!1,!1],this.allowInvalid=!0,this.getFullName=function(a){if(a){var b=a.name.nombres,c=a.name.apellidos;return this.fullName=[b[0],b[1],c[0],c[1]].join(" ")}},this.togglePassword=function(a){this.showPassword[a]=!this.showPassword[a]},this.pswdInvalidChars=function(){return _.uniq(this.password.split("").filter(function(a){return!/[a-zA-Z0-9-!@#$%^&*()_[\]{},.<>+=]/.test(a)})).join(",").replace(" ","[espacio]")},this.save=function(){var a={};return this.email&&(a.email=this.email),this.phone&&this.code&&(a.phone={code:this.code,number:parseInt(this.phone)}),this.password&&(a.password=b.encode(this.password)),this.onSave({profile:a,fullname:this.fullName})},a.$watch("$ctrl.data",function(a){a&&(this.email=a.email,this.email_confirm=a.email,a.phone?(this.phone=a.phone.number,this.code=a.phone.code,this.phone_confirm=a.phone.number,this.code_confirm=a.phone.code):(this.phone=null,this.phone_confirm=null,this.code="+56",this.code_confirm="+56"))}.bind(this))}function UserLoginFormController(a,b){"ngInject";this.save=function(a){return this.onSave({user:a})}}function UserButtonController(a,b){"ngInject";this.fullName="",this.user=null,this.loggedIn=!1,this.getUserData=function(){var a=this.user.object.name.nombres,b=this.user.object.name.apellidos;this.fullName=[a[0],a[1],b[0],b[1]].join(" ")},this.logout=function(){this.user=null,a.logout()},this.login=function(b){a.login(b)},b.$watch(function(){return this.user}.bind(this),function(a,b){a&&(this.getUserData(),this.loggedIn=!0)}.bind(this))}function AccessController(a,b,c,d,e,f,g){"ngInject";a.user={},a.accessUser=function(b){return d.authenticateUser(b.run,b.password).then(function(b){null!=b.token?(localStorage.setItem("token",b.token),f.check().then(function(a){window.location="/"+localStorage.getItem("pre_url")})["catch"](function(b){a.message=g.response(0)})):a.message=g.response(b.code)})["catch"](function(b){a.message=g.response(0)})},null!=localStorage.getItem("token")&&(localStorage.removeItem("pre_url"),window.location="/")}function ActivateController(a,b,c,d,e){"ngInject";a.user={},angular.element(document).ready(function(){$("#activation_code").bind("keyup",function(a){if(a.which>=97&&a.which<=122){var b=a.which-32;a.keyCode=b,a.charCode=b}$("#activation_code").val($("#activation_code").val().toUpperCase())})}),a.logged=!1,e.getUser().then(function(b){a.logged=!0}),a.activate=function(){return c.activateUser(a.user).then(function(c){null!=c.token?(localStorage.setItem("token",c.token),b.go("citizen.activation.config",{data:angular.extend(c.object,a.user)})):a.message=d.response(c.code)})["catch"](function(b){a.message=d.response(0)})}}function ActivateminiController(a,b,c,d){"ngInject";a.user={},a.activate=function(){return c.activateUser(a.user).then(function(c){null!=c.token?(localStorage.setItem("token",c.token),b.go("citizen.activation_mini.configmini",{data:angular.extend(c.object,a.user)})):a.message=Messages.response(c.code)})["catch"](function(b){a.apiError=b.status,a.message=b.data?b.data.error||b.data.message:"Ha ocurrido un error. Por favor intente nuevamente"})}}function ActivityController(a,b,c){"ngInject";a.activities=[],c.getUser().then(function(c){b.getActivity(c.rut).then(function(b){a.activities=b})})}function ConfigController(a,b,c){"ngInject";a.result=null,a.data=b.data,a.modifyData=function(b,d){return c.createUser(a.data.numero,b).then(function(){a.result="success",a.profile=b,a.fullname=d,localStorage.removeItem("token")})["catch"](function(){a.result="error"})}}function ConfigminiController(a,b,c){"ngInject";a.result=null,a.data=b.data,a.modifyData=function(b,d){return c.createUser(a.data.numero,b).then(function(){a.result="success",a.profile=b,a.fullname=d,localStorage.removeItem("token")})["catch"](function(){a.result="error"})}}function HomeController(a,b,c){"ngInject";a.data={numberUsers:0,numberInstitutions:0,numberApps:0,numberTransactionsDay:0},a.statusClss=["offline","online","maintenance"],a.getMetrics=function(){return b.getMetrics().then(function(b){a.data=b,a.status=a.statusClss[b.statusClaveUnica]})["catch"](function(b){a.error=b})},a.getMetrics()}function OfficeController(a,b,c,d){"ngInject";a.regions=[],a.cities=[],a.validCities=[];var e={codigo:"13101",latitude:-33.4417,longitude:-70.6541};a.map={center:{latitude:e.latitude,longitude:e.longitude},zoom:12},b.getOfficesByCity(e).then(function(b){a.map={center:{latitude:e.latitude,longitude:e.longitude},zoom:12},1==b.length&&(a.map.center=b[0].coordinates),a.offices=b}),a.control={},a.prefetchCities=function(){return b.getCitiesCodes().then(function(b){a.validCities=b})},a.getRegions=function(){return b.getRegions().then(function(b){a.regions=b})},a.changeRegion=function(c){return b.getCitiesByRegion(c,a.validCities).then(function(b){a.cities=b})},a.getNearOffices=function(){function c(c){var d=c.coords;return b.getNearOfficesByLatlng(d).then(function(b){a.map={center:{latitude:d.latitude,longitude:d.longitude},zoom:12},a.offices=b})}a.offices=[],angular.element(".office-loading-spinner").removeClass("hide"),d.getCurrentPosition().then(c)},a.getCityOffices=function(c){return c?(a.offices=[],angular.element(".office-loading-spinner").removeClass("hide"),b.getOfficesByCity(c).then(function(b){a.map={center:{latitude:c.latitude,longitude:c.longitude},zoom:12},1==b.length&&(a.map.center=b[0].coordinates),a.offices=b})):void 0},a.prefetchCities().then(a.getRegions)}function ProfileController(a,b,c){"ngInject";a.data=null,a.result=null,a.modifyData=function(c,d){return b.updateUser(c,a.data.rut).then(function(){a.result="success",a.profile=c,a.fullname=d})["catch"](function(){a.result="success"})},c.getUser().then(function(b){a.data={name:b.object.name,email:b.object.other_info.email,phone:b.object.other_info.phone,rut:b.rut}})}function TasksController(a,b){"ngInject";a.tasks=[],a.services={},a.getServices=function(){return b.getServices().then(function(b){a.services=b})},a.changeService=function(c){return b.getTasksByService(c).then(function(b){a.updateTasks(b.data.object)})},a.updateTasks=function(b){a.tasks=[],angular.forEach(b,function(b){var c=a.services[b.institucion];void 0!==c&&a.tasks.push(angular.extend(b,{institution_name:c.nombre}))})},a.getRandomTasks=function(c){return b.getRandomTasks(c).then(function(b){a.updateTasks(b.data.object)})},a.getTasks=function(){return a.getServices().then(function(){a.getRandomTasks(120)})}}function MetricsController(a,b,c){"ngInject";a.data={numberUsers:0,numberInstitutions:0,numberApps:0,numberTransactionsDay:0},a.statusClss=["offline","online","maintenance"],a.getMetrics=function(){return b.getMetrics().then(function(b){a.data=b,a.status=a.statusClss[b.statusClaveUnica]})["catch"](function(b){a.error=b})},a.getMetrics();var d=c(function(){a.getMetrics()},1e3);a.$on("$destroy",function(){c.cancel(d)})}function RequestController(a,b,c,d){"ngInject";a.regex="\\+(?:[0-9] ?){6,14}[0-9]",a.request={nameApp:null,urlProd:null,urlSandbox:null,institution:null,phoneContactAdm:null,phoneContactTec:null,emailContactAdm:null,emailContactTec:null,nameContactAdm:null,nameContactTec:null,descriptionApp:null,procedureUrl:null},a.onRequestSuccess=function(d){a.data=d.data.object,localStorage.setItem("session",d.data.session),a.downloadLink=c.getCredentialsFileLink(),b.open({animation:!1,templateUrl:"credentialsModal.html",scope:a,backdrop:!1,controller:["$scope","$state",function(a,b){a.downloadFile=function(){c.downloadFileAjax()},a.dismissModal=function(){b.go("institutional.home")}}]})},a.submit=function(){return["urlProd","procedureUrl"].forEach(function(b){a.request[b]&&a.request[b].length||delete a.request[b]}),c.requestCredentials(a.request).then(a.onRequestSuccess)["catch"](function(b){"URL Sandbox"==b.data.params[0]&&(a.error="La URL de Test no es válida"),"URL Prod"==b.data.params[0]&&(a.error="La URL de Producción no es válida"),"URL Producción"==b.data.params[0]&&(a.error="La URL de Producción no es válida"),"Descripción"==b.data.params[0]&&(a.error="La Descripción no debe superar los 1000 carateres")})}}function TutorialController(a){"ngInject";a.steps=["Paso 1","Paso 2","Paso 3","Paso 4","Paso 5","Paso 6"],a.selected=0}function CompareTo(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b===a.otherModelValue},a.$watch("otherModelValue",function(){d.$validate()}),a.$watch(c.ngModel,function(){d.$validate()})}}}function RouterCiudadano(a){"ngInject";a.state("citizen",{"abstract":!0,url:"/",templateUrl:"views/citizen/index.html"}).state("citizen.home",{url:"",templateUrl:"views/citizen/home.html",controller:"HomeController",data:{pageTitle:"Inicio"}}).state("citizen.login",{url:"acceder",templateUrl:"views/citizen/login.html",controller:"AccessController",data:{pageTitle:"Acceder"}}).state("citizen.login.form",{url:"",templateUrl:"views/citizen/login.html",controller:"AccessController",data:{pageTitle:"Acceder"}}).state("citizen.about",{url:"que-es",templateUrl:"views/citizen/about.html",data:{pageTitle:"¿Qué es?"}}).state("citizen.tos",{url:"terminos-y-condiciones",templateUrl:"views/citizen/tos.html",data:{pageTitle:"Términos y condiciones"}}).state("citizen.getit",{url:"como-obtenerla",templateUrl:"views/citizen/get-it.html",data:{pageTitle:"Cómo obtenerla"}}).state("citizen.faqs",{url:"preguntas-frecuentes",templateUrl:"views/citizen/faqs.html",controller:"FaqsController",data:{pageTitle:"Preguntas Frecuentes"}}).state("citizen.offices",{url:"oficinas",templateUrl:"views/citizen/offices.html",controller:"OfficesController",data:{pageTitle:"Donde obtenerla"}}).state("citizen.tasks",{url:"operaciones",templateUrl:"views/citizen/tasks.html",controller:"TasksController as ctrl",data:{pageTitle:"Operaciones disponibles"}}).state("citizen.activation",{"abstract":!0,url:"activar",template:"<ui-view />"}).state("citizen.activation.form",{url:"",templateUrl:"views/citizen/activate.html",controller:"ActivateController",data:{pageTitle:"Activar clave"}}).state("citizen.activation.config",{templateUrl:"views/citizen/config.html",controller:"ConfigController",data:{pageTitle:"Configurar mis datos"},params:{data:null}}).state("citizen.activation_mini",{"abstract":!0,url:"activar_mini",template:"<ui-view />"}).state("citizen.activation_mini.form",{url:"",templateUrl:"views/citizen/activate_mini.html",controller:"ActivateminiController",data:{pageTitle:"Activar clave mini"}}).state("citizen.activation_mini.configmini",{templateUrl:"views/citizen/configmini.html",controller:"ConfigminiController",data:{pageTitle:"Configurar mis datos mini"},params:{data:null}}).state("citizen.activity",{url:"actividad",templateUrl:"views/citizen/activity.html",controller:"ActivityController",data:{pageTitle:"Últimos movimientos"},resolve:{user:["session",function(a){a.getUser()["catch"](function(){a.login("citizen.activity")})}]}}).state("citizen.credentials",{url:"mis-credenciales",templateUrl:"views/citizen/credentials.html",controller:"CredentialsController",data:{pageTitle:"Mis Credenciales"},resolve:{user:["session",function(a){a.getUser()["catch"](function(){a.login("citizen.credentials")})}]}}).state("citizen.profile",{url:"perfil",templateUrl:"views/citizen/profile.html",controller:"ProfileController",data:{pageTitle:"Actualizar datos"},resolve:{user:["session",function(a){a.getUser()["catch"](function(){a.login("citizen.profile")})}]}}).state("citizen.recovery",{"abstract":!0,url:"recuperar",template:"<ui-view/>"}).state("citizen.recovery.form",{url:"",templateUrl:"views/citizen/recovery.html",controller:"RecoveryController",data:{pageTitle:"Recuperar Clave"}})}function RouterInstitucional(a){"ngInject";a.state("institutional",{"abstract":!0,url:"/institucional",templateUrl:"views/institutional/index.html"}).state("institutional.home",{url:"",templateUrl:"views/institutional/home.html",data:{pageTitle:"Portal Institucional"}}).state("institutional.soporte",{url:"/soporte",templateUrl:"views/institutional/soporte.html",controller:"SoporteController",data:{pageTitle:"Soporte"},resolve:{user:["session",function(a){a.getUser()["catch"](function(){a.login("institutional.soporte")})}]}}).state("institutional.credentials",{url:"/admin-credenciales",templateUrl:"views/institutional/credentials.html",controller:"CredentialsController",data:{pageTitle:"Credenciales"},resolve:{user:["session",function(a){a.getUser()["catch"](function(){a.login("institutional.credentials")})}]}}).state("institutional.agentes",{url:"/agentes",templateUrl:"views/institutional/agentes.html",controller:"SoporteController",data:{pageTitle:"Agentes"},resolve:{user:["session",function(a){a.getUser()["catch"](function(){a.login("institutional.agentes")})}]}}).state("institutional.request",{url:"/solicitud-activacion",templateUrl:"views/institutional/request.html",controller:"RequestController",data:{pageTitle:"Solicitud de activación"},resolve:{user:["session",function(a){a.getUser()["catch"](function(){a.login("institutional.request")})}]}}).state("institutional.how",{url:"/como-funciona",templateUrl:"views/institutional/how-it-works.html",data:{pageTitle:"Cómo funciona"}}).state("institutional.tutorial",{url:"/manual-de-instalacion",templateUrl:"views/institutional/tutorial.html",controller:"TutorialController",data:{pageTitle:"Guía técnica"}}).state("institutional.charts",{url:"/estadisticas",templateUrl:"views/institutional/charts.html",data:{pageTitle:"Estadísticas de uso"}})}angular.module("claveunica",["LocalStorageModule","angularPromiseButtons","angularUtils.directives.dirPagination","base64","elif","ngIntlTelInput","ngCookies","ngGeolocation","ngMessages","ngPageTitle","ngSanitize","nvd3","router-citizen","router-institutional","satellizer","ui.bootstrap","ui.bootstrap.showErrors","ui.mask","uiGmapgoogle-maps","vcRecaptcha"]).config(["$urlRouterProvider","$httpProvider","$locationProvider","vcRecaptchaServiceProvider","localStorageServiceProvider","uiGmapGoogleMapApiProvider","$authProvider","ngIntlTelInputProvider",function(a,b,c,d,e,f,g,h){"ngInject";c.html5Mode({enabled:!0,requireBase:!1}),h.set({preferredCountries:["cl"],initialCountry:"cl"}),a.otherwise("/"),e.setPrefix("claveunica"),b.interceptors.push("HttpInterceptor"),d.setDefaults({key:angular.element("meta[name=recaptcha-key]").attr("content")}),f.configure({key:angular.element("meta[name=gmaps-key]").attr("content"),v:"3.exp"});var i=angular.element("meta[name=api-endpoint]");g.oauth2({name:"claveunica",url:"/auth/claveunica",clientId:"123",redirectUri:window.encodeURIComponent(window.location.origin),authorizationEndpoint:_.trimEnd(i.attr("content"),"/"),scope:["openid","run"],scopeDelimiter:" ",responseType:"code",state:function(){return(Date.now()+Math.random()).replace(".","")},defaultUrlParams:["scope","client_id","redirect_uri","state","response_type"]})}]).filter("formatPrice",function(){return function(a,b,c,d,e){var f;b="undefined"==typeof b?0:b,e="undefined"==typeof e?!0:e,c="undefined"==typeof c?".":c,d="undefined"==typeof d?"":d,a=a.toString();var g=a.split("."),h="undefined"==typeof g[1]?"":g[1];if(e&&0===parseInt(h,10));else for(h=h.toString(),h.length>b&&(h=Math.round(parseFloat("0."+h)*Math.pow(10,b)).toString()),f=h.length;b>f;f++)h+="0";var i=g[0],j="",k=0;for(f=i.length-1;f>-1;f--)j=(k++%3===2&&f>0?c:"")+i.substr(f,1)+j;return j+d+h}}).run(["$rootScope","$state","$stateParams","session",function(a,b,c,d){"ngInject";a.$state=b,a.$stateParams=c,a.$session=d}]),HttpInterceptor.$inject=["$cookies"],angular.module("claveunica").service("HttpInterceptor",HttpInterceptor),angular.module("claveunica").service("RutHelper",RutHelper),storage.$inject=["localStorageService"],angular.module("claveunica").service("$storage",storage),session.$inject=["Api","$cacheFactory","$storage","$q","$window","Messages","$state"],angular.module("claveunica").service("session",session);var geolocationSvc=function(a,b){function c(){var c=a.defer();return b.navigator.geolocation?b.navigator.geolocation.getCurrentPosition(function(a){c.resolve(a)},function(a){c.reject(a)}):c.reject("Geolocation not supported."),c.promise}return{getCurrentPosition:c}};geolocationSvc.$inject=["$q","$window"],angular.module("claveunica").factory("geolocationSvc",geolocationSvc),Api.$inject=["$http","$q","$base64","$cacheFactory"],angular.module("claveunica").service("Api",Api),angular.module("claveunica").service("Messages",Messages),DashboardChartController.$inject=["Api"],angular.module("claveunica").component("dashboardChart",{bindings:{chart:"<",institution:"<"},controller:DashboardChartController,templateUrl:"views/components/dashboard-chart.html"}),SiteFooterController.$inject=["$transclude"],
angular.module("claveunica").component("siteFooter",{transclude:{content:"?content"},templateUrl:"views/footer.html",controller:SiteFooterController}),SiteHeaderController.$inject=["session","$state","$storage"],angular.module("claveunica").component("siteHeader",{templateUrl:"views/header.html",controller:SiteHeaderController}),UserFormController.$inject=["$scope","$base64"],angular.module("claveunica").component("userForm",{bindings:{data:"<",onSave:"&"},templateUrl:"views/components/user-form.html",controller:UserFormController}),UserLoginFormController.$inject=["$scope","$base64"],angular.module("claveunica").component("userLoginForm",{bindings:{data:"<",onSave:"&"},templateUrl:"views/components/user-login-form.html",controller:UserLoginFormController}),UserButtonController.$inject=["session","$scope"],angular.module("claveunica").component("userButton",{bindings:{isMobile:"<",user:"="},templateUrl:"views/components/user-button.html",controller:UserButtonController}),AccessController.$inject=["$scope","$state","$location","Api","$http","session","Messages"],angular.module("claveunica").controller("AccessController",AccessController),ActivateController.$inject=["$scope","$state","Api","Messages","session"],angular.module("claveunica").controller("ActivateController",ActivateController),ActivateminiController.$inject=["$scope","$state","Api","session"],angular.module("claveunica").controller("ActivateminiController",ActivateminiController),ActivityController.$inject=["$scope","Api","session"],angular.module("claveunica").controller("ActivityController",ActivityController),ConfigController.$inject=["$scope","$stateParams","Api"],angular.module("claveunica").controller("ConfigController",ConfigController),ConfigminiController.$inject=["$scope","$stateParams","Api"],angular.module("claveunica").controller("ConfigminiController",ConfigminiController);var app=angular.module("claveunica");app.controller("FaqsController",["$scope","Api",function(a,b){"ngInject";b.getFaqs().then(function(b){a.faqs=b},function(){a.error=!0})}]),HomeController.$inject=["$scope","Api","$interval"],angular.module("claveunica").controller("HomeController",HomeController),OfficeController.$inject=["$scope","Api","$geolocation","geolocationSvc"],angular.module("claveunica").controller("OfficesController",OfficeController),ProfileController.$inject=["$scope","Api","session"],angular.module("claveunica").controller("ProfileController",ProfileController);var app=angular.module("claveunica");app.controller("RecoveryController",["$scope","Api","Messages",function(a,b,c){"ngInject";a.humanOk=!1,a.methods=[],a.sendRecovery=function(d){return b.sendRecovery(a.run,d).then(function(b){a.recoveryOk=!0,a.recoveryMethod=d,a.apiError=b.data.status,a.message=c.response(b.data.code,b.data.params[0]),localStorage.removeItem("token")})["catch"](function(b){a.recoveryOk=!1,a.apiError=b.status,a.message=c.response(500,"")})},a.isHuman=function(){a.humanOk=!0,a.loadMethods(a.run)},a.loadMethods=function(d){return localStorage.removeItem("token"),b.recoveryOptions(d).then(function(b){localStorage.setItem("token",b.data.token);var c=b.data.object.methods;return 1===c.length?a.sendRecovery(c[0]):void(a.methods=c)})["catch"](function(b){a.apiError=b.data.status,a.message=c.response(500,"")})},a.showOptions=function(b){return a.humanOk&&b.run.$valid},a.resetForm=function(){a.run=a.captcha=a.apiError=null,a.humanOk=!1}}]),TasksController.$inject=["$scope","Api"],angular.module("claveunica").controller("TasksController",TasksController),MetricsController.$inject=["$scope","Api","$interval"],angular.module("claveunica").controller("MetricsController",MetricsController),RequestController.$inject=["$scope","$uibModal","Api","Messages"],angular.module("claveunica").controller("RequestController",RequestController),TutorialController.$inject=["$scope"],angular.module("claveunica").controller("TutorialController",TutorialController);var app=angular.module("claveunica");app.directive("ngConfirmClick",[function(){return{link:function(a,b,c){var d=c.ngConfirmClick||"Are you sure?",e=c.confirmedClick;b.bind("click",function(b){window.confirm(d)&&a.$eval(e)})}}}]),app.controller("SoporteController",["$scope","Api","Messages","RutHelper",function(a,b,c,d){"ngInject";a.regex="\\+(?:[0-9] ?){6,14}[0-9]",a.request={run:null},a.result="",a.error="",a.message="",a.token_recovery="",a.token_session="",a.error_new="",a.result_new="",a.isAdmin=!1;var e=localStorage.getItem("token"),f=e.split("."),g=JSON.parse(atob(f[1]));a.institucion="",g.support.institution&&(a.institucion=g.support.institution),g.support.admin&&(a.isAdmin=!0,b.getAgents().then(function(b){a.agents=b})["catch"](function(b){a.error=b})),a.limpiarForm=function(){a.result="",a.error="",a.message="",a.run="",a.ciudadano_run="",a.ciudadano_nombre="",a.ciudadano_run="",a.ciudadano_telefono="",a.ciudadano_email="",a.ciudadano_enrolamiento="",a.ciudadano_activacion="",a.ciudadano_bloqueado="",a.ciudadano_intentos="",a.ciudadano_intentos_fecha="",a.ciudadano_estado=""},a.showEditEmail=function(){$("#btn_editar_email").hide(),$("#email_new").show(),$("#btn_cancelar_guardar_email").show(),$("#btn_guardar_email").show()},a.cancelNewEmail=function(){$("#email_new").val(""),$("#email_new").hide(),$("#btn_cancelar_guardar_email").hide(),$("#btn_guardar_email").hide(),$("#btn_editar_email").show()},a.sendRecoveryBySupport=function(d){a.token_session=localStorage.getItem("token"),localStorage.setItem("token",a.token_recovery),b.sendRecoveryAccount(a.run,d).then(function(b){a.token_recovery="",localStorage.setItem("token",a.token_session),a.token_session="",a.message=c.response(b.code,b.params[0])})},a.deleteAgent=function(c){b.deleteAgent(c).then(function(c){b.getAgents().then(function(b){a.agents=b})["catch"](function(b){a.error=b}),a.error_new="",a.result_new="",document.getElementById("form_new").reset(),document.getElementById("form_new_agent").style.display="none"})},a.cancelNewAgent=function(){a.error_new="",a.result_new="",showDiv("form_new_agent")},a.saveNewEmail=function(d){var e=d,f=a.email_new,g=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;0==g.test(f)?alert("El email es incorrecto"):b.sendUpdateEmail(e,f).then(function(d){75==d.code?alert("El email no puede modificarse más de una vez en 24 horas"):76==d.code?alert("Modificación no permitida"):55==d.code?(alert("El email fue actualizado exitosamente"),$("#email_new").val(""),$("#email_new").hide(),$("#btn_cancelar_guardar_email").hide(),$("#btn_guardar_email").hide(),$("#btn_editar_email").show(),a.email_new="",""!=a.token_session&&localStorage.setItem("token",a.token_session),a.run&&b.getCitizenData(a.run).then(function(b){var d=a.run.replace(".","");if(d=d.replace(".",""),d=d.replace("-",""),d=d.slice(0,-1),$.ajax({url:"https://portal.claveunica.gob.cl/api/v1/users/"+d+"/recovery"}).done(function(b){a.token_recovery=b.token}),"ok"==b.status){for(var e="",f=b.object.user,g=0;g<f.name.nombres.length;g++)e+=f.name.nombres[g]+" ";for(var h=0;h<f.name.apellidos.length;h++)e+=f.name.apellidos[h]+" ";var i="";f.other_info.phone&&(i=f.other_info.phone.code+f.other_info.phone.number);var j="",k="";a.ciudadano_estado="Enrolado",f.enrolled_datetime&&(j=f.enrolled_datetime),f.activation_datetime&&(k=f.activation_datetime,a.ciudadano_estado="Activado");var l="No";1==f.block_status&&(l="Si");var m="-";f.failed_login.first_failed&&(m=f.failed_login.first_failed),a.result="resultado",a.ciudadano_run=a.run,a.ciudadano_nombre=e,a.ciudadano_telefono=i,a.ciudadano_email=f.other_info.email,a.ciudadano_enrolamiento=j,a.ciudadano_activacion=k,a.ciudadano_bloqueado=l,a.ciudadano_intentos=f.failed_login.number_attemps,a.ciudadano_intentos_fecha=m}else a.error=c.response(b.data.code),a.resutl=c.response(b.data.code)},function(b){a.error=c.response(b.data.code),a.resutl=c.response(b.data.code)})):alert("Ocurrio un error, intente nuevamente")})},a.saveAgent=function(){a.error_new="",a.result_new="";var e=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/,f=/^((\+[1-9]{1,4}[ \-]*)|(\([0-9]{2,3}\)[ \-]*)|([0-9]{2,4})[ \-]*)*?[0-9]{3,4}?[ \-]*[0-9]{3,4}?$/;if(a.agent_name=a.agent_name.trim(),a.agent_lastname=a.agent_lastname.trim(),a.agent_email=a.agent_email.trim(),a.agent_phonenumber=a.agent_phonenumber.trim(),1==d.validar(a.agent_run))if(a.agent_name.length>30||0==/^[ñÑA-Za-z ]*[ñÑA-Za-z][ñÑA-Za-z áéíóú]*$/.test(a.agent_name))a.error_new="error",a.result_new="El nombre no debe superar los 30 caracteres ni incluir números";else if(a.agent_lastname.length>30||0==/^[ñÑA-Za-z ]*[ñÑA-Za-z][ñÑA-Za-z áéíóú]*$/.test(a.agent_lastname))a.error_new="error",a.result_new="El apellido no debe superar los 30 caracteres ni incluir números";else if(0==e.test(a.agent_email))a.error_new="error",a.result_new="El email es incorrecto";else if(0==f.test(a.agent_phonenumber))a.error_new="error",a.result_new="El formato del número es incorrecto";else if(12!=a.agent_phonenumber.length)a.error_new="error",a.result_new="El número telefónico debe tener 12 caracteres (incluyendo el +)";else{a.temp_agent_phonenumber=a.agent_phonenumber.substr(3);var g=parseInt(a.agent_run.split("-")[0].split(".").join("")),h=a.agent_run.substr(a.agent_run.length-1);h=h.toUpperCase();var i='{"other_info" : {  "phone" : {"code" : "+56", "number" : '+a.temp_agent_phonenumber+'}, "email" : "'+a.agent_email+'"}, "name" : {"apellidos" : [ "'+a.agent_lastname+'" ], "nombres" : [ "'+a.agent_name+'" ]}, "RolUnico" : {"DV" : "'+h+'","numero" : '+g+',"tipo" : "RUN"}}';b.sendNewAgent(i).then(function(d){"ok"==d.status?(alert("Agente creado exitosamente"),b.getAgents().then(function(b){a.agents=b})["catch"](function(b){a.error=b}),showDiv("form_new_agent")):(a.error_new="error",a.result_new=c.response(d.code,""))})}else a.error_new="error",a.result_new=c.response(23)},a.submit=function(){$("#email_new").val(""),$("#email_new").hide(),$("#btn_cancelar_guardar_email").hide(),$("#btn_guardar_email").hide(),$("#btn_editar_email").show(),""!=a.token_session&&localStorage.setItem("token",a.token_session),a.run&&b.getCitizenData(a.run).then(function(b){var d=a.run.replace(".","");if(d=d.replace(".",""),d=d.replace("-",""),d=d.slice(0,-1),$.ajax({url:"https://portal.claveunica.gob.cl/api/v1/users/"+d+"/recovery"}).done(function(b){a.token_recovery=b.token}),"ok"==b.status){for(var e="",f=b.object.user,g=0;g<f.name.nombres.length;g++)e+=f.name.nombres[g]+" ";for(var h=0;h<f.name.apellidos.length;h++)e+=f.name.apellidos[h]+" ";var i="";f.other_info.phone&&(i=f.other_info.phone.code+f.other_info.phone.number);var j="",k="";a.ciudadano_estado="Enrolado",f.enrolled_datetime&&(j=f.enrolled_datetime),f.activation_datetime&&(k=f.activation_datetime,a.ciudadano_estado="Activado");var l="No";1==f.block_status&&(l="Si");var m="-";f.failed_login.first_failed&&(m=f.failed_login.first_failed),a.result="resultado",a.ciudadano_run=a.run,a.ciudadano_nombre=e,a.ciudadano_telefono=i,a.ciudadano_email=f.other_info.email,a.ciudadano_enrolamiento=j,a.ciudadano_activacion=k,a.ciudadano_bloqueado=l,a.ciudadano_intentos=f.failed_login.number_attemps,a.ciudadano_intentos_fecha=m}else a.error=c.response(b.data.code),a.resutl=c.response(b.data.code)},function(b){a.error=c.response(b.data.code),a.resutl=c.response(b.data.code)})}}]);var app=angular.module("claveunica");app.config(["$provide",function(a){"ngInject";a.decorator("$http",["$delegate",function(a){return a.url=function(b){var c=a.getEndpoint()+b;if(arguments.length>1){var d=arguments,e=1;return c.replace(/{\w+?}/g,function(){return d[e++]})}return c},a.setEndpoint=function(b){a.endpoint=b},a.getEndpoint=function(){return a.endpoint},a}])}]),angular.module("claveunica").directive("compareTo",CompareTo),angular.module("claveunica").directive("countryCodeSelect",["$parse",function(a){return{restrict:"A",template:'<select><option ng-repeat="(key, value) in countries" value="{{ value }}">{{ key }} ({{ value }})</option></select>',replace:!0,link:function(b,c,d){var e;return b.countries={Afghanistan:"+93",Albania:"+355",Algeria:"+213","American Samoa":"+684",Andorra:"+376",Angola:"+244",Anguilla:"+264",Antarctica:"+672","Antigua and Barbuda":"+268",Argentina:"+54",Armenia:"+374",Aruba:"+297",Australia:"+61",Austria:"+43",Azerbaijan:"+994",Bahamas:"+242",Bahrain:"+973",Bangladesh:"+880",Barbados:"+246",Belarus:"+375",Belgium:"+32",Belize:"+501",Benin:"+229",Bermuda:"+441",Bhutan:"+975","Bolivia, Plurinational State of":"+591","Bonaire, Sint Eustatius and Saba":"+599","Bosnia and Herzegovina":"+387",Botswana:"+267","Bouvet Island":"+47",Brazil:"+55","British Indian Ocean Territory":"+246","Brunei Darussalam":"+673",Bulgaria:"+359","Burkina Faso":"+226",Burundi:"+257",Cambodia:"+855",Cameroon:"+237",Canada:"+1","Cape Verde":"+238","Cayman Islands":"+345","Central African Republic":"+236",Chad:"+235",Chile:"+56",China:"+86","Christmas Island":"+61","Cocos (Keeling) Islands":"+891",Colombia:"+57",Comoros:"+269",Congo:"+242","Congo, the Democratic Republic of the":"+243","Cook Islands":"+682","Costa Rica":"+506",Croatia:"+385",Cuba:"+53","Curaçao":"+599",Cyprus:"+357","Czech Republic":"+420","Côte d'Ivoire":"+225",Denmark:"+45",Djibouti:"+253",Dominica:"+767","Dominican Republic":"+809",Ecuador:"+593",Egypt:"+20","El Salvador":"+503","Equatorial Guinea":"+240",Eritrea:"+291",Estonia:"+372",Ethiopia:"+251","Falkland Islands (Malvinas)":"+500","Faroe Islands":"+298",Fiji:"+679",Finland:"+358",France:"+33","French Guiana":"+594","French Polynesia":"+689","French Southern Territories":"+689",Gabon:"+241",Gambia:"+220",Georgia:"+995",Germany:"+49",Ghana:"+233",Gibraltar:"+350",Greece:"+30",Greenland:"+299",Grenada:"+473",Guadeloupe:"+590",Guam:"+671",Guatemala:"+502",Guernsey:"+1481",Guinea:"+225","Guinea-Bissau":"+245",Guyana:"+592",Haiti:"+509","Heard Island and McDonald Islands":"+61","Holy See (Vatican City State)":"+379",Honduras:"+504","Hong Kong":"+852",Hungary:"+36",Iceland:"+354",India:"+91",Indonesia:"+62","Iran, Islamic Republic of":"+98",Iraq:"+964",Ireland:"+353","Isle of Man":"+44",Israel:"+972",Italy:"+39",Jamaica:"+876",Japan:"+81",Jersey:"+44",Jordan:"+962",Kazakhstan:"+7",Kenya:"+254",Kiribati:"+686","Korea, Democratic People's Republic of":"+850","Korea, Republic of":"+82",Kuwait:"+965",Kyrgyzstan:"+996","Lao People's Democratic Republic":"+856",Latvia:"+371",Lebanon:"+961",Lesotho:"+266",Liberia:"+231",Libya:"+218",Liechtenstein:"+423",Lithuania:"+370",Luxembourg:"+352",Macao:"+853","Macedonia, The Former Yugoslav Republic of":"+389",Madagascar:"+261",Malawi:"+265",Malaysia:"+60",Maldives:"+960",Mali:"+223",Malta:"+356","Marshall Islands":"+692",Martinique:"+596",Mauritania:"+222",Mauritius:"+230",Mayotte:"+262",Mexico:"+52","Micronesia, Federated States of":"+691","Moldova, Republic of":"+373",Monaco:"+355",Mongolia:"+976",Montenegro:"+382",Montserrat:"+664",Morocco:"+212",Mozambique:"+258",Myanmar:"+95",Namibia:"+264",Nauru:"+674",Nepal:"+977",Netherlands:"+31","New Caledonia":"+687","New Zealand":"+64",Nicaragua:"+505",Niger:"+277",Nigeria:"+234",Niue:"+683","Norfolk Island":"+672","Northern Mariana Islands":"+670",Norway:"+47",Oman:"+968",Pakistan:"+92",Palau:"+680","Palestinian Territory, Occupied":"+970",Panama:"+507","Papua New Guinea":"+675",Paraguay:"+595",Peru:"+51",Philippines:"+63",Pitcairn:"+872",Poland:"+48",Portugal:"+351","Puerto Rico":"+787",Qatar:"+974",Romania:"+40","Russian Federation":"+7",Rwanda:"+250","Réunion":"+262","Saint Barthélemy":"+590","Saint Helena, Ascension and Tristan da Cunha":"+290","Saint Kitts and Nevis":"+869","Saint Lucia":"+758","Saint Martin (French part)":"+590","Saint Pierre and Miquelon":"+508","Saint Vincent and the Grenadines":"+784",Samoa:"+685","San Marino":"+378","Sao Tome and Principe":"+239","Saudi Arabia":"+966",Senegal:"+221",Serbia:"+381",Seychelles:"+248","Sierra Leone":"+232",Singapore:"+65","Sint Maarten (Dutch part)":"+599",Slovakia:"+421",Slovenia:"+386","Solomon Islands":"+677",Somalia:"+252","South Africa":"+27","South Georgia and the South Sandwich Islands":"+500","South Sudan":"+211",Spain:"+34","Sri Lanka":"+94",Sudan:"+249",Suriname:"+597","Svalbard and Jan Mayen":"+47",Swaziland:"+268",Sweden:"+46",Switzerland:"+41","Syrian Arab Republic":"+963","Taiwan, Province of China":"+886",Tajikistan:"+992","Tanzania, United Republic of":"+255",Thailand:"+66","Timor-Leste":"+670",Togo:"+228",Tokelau:"+690",Tonga:"+676","Trinidad and Tobago":"+868",Tunisia:"+216",Turkey:"+90",Turkmenistan:"+993","Turks and Caicos Islands":"+649",Tuvalu:"+688",Uganda:"+256",Ukraine:"+380","United Arab Emirates":"+971","United Kingdom":"+44","United States":"+1","United States Minor Outlying Islands":"+1",Uruguay:"+598",Uzbekistan:"+998",Vanuatu:"+678","Venezuela, Bolivarian Republic of":"+58","Viet Nam":"+84","Virgin Islands, British":"+284","Virgin Islands, U.S.":"+340","Wallis and Futuna":"+681","Western Sahara":"+212",Yemen:"+967",Zambia:"+260",Zimbabwe:"+263","Åland Islands":"+358"},d.ngModel?(e=a(d.ngModel).assign,c.bind("change",function(a){return e(a.val())}),b.$watch(d.ngModel,function(a){return c.val(a)})):void 0}}}]);var app=angular.module("claveunica");app.directive("strongPass",function(){return{require:"ngModel",restrict:"A",link:function(a,b,c,d){b.on("focus",function(){d.$setValidity("invalidchar",!0),d.$setValidity("strongPassword",!0),a.$apply()}),b.on("blur",function(){var b=/^[a-zA-Z0-9-!@#$%^&*()_[\]{},.<>+=]+$/,c=d.$viewValue;if(d.$setValidity("invalidchar",c.length&&b.test(c)),a.$apply(),c.length&&b.test(c)){var e=/^(?:(?=.*?[A-Z])(?:(?=.*?[0-9])(?=.*?[-!@#$%^&*()_[\]{},.<>+=])|(?=.*?[a-z])(?:(?=.*?[0-9])|(?=.*?[-!@#$%^&*()_[\]{},.<>+=])))|(?=.*?[a-z])(?=.*?[0-9])(?=.*?[-!@#$%^&*()_[\]{},.<>+=]))[A-Za-z0-9!@#$%^&*()_[\]{},.<>+=-]{8,50}$/,f=!1;e.test(c)&&(f=!0),d.$setValidity("strongPassword",f),a.$apply()}})}}});var app=angular.module("claveunica");app.directive("validateRut",["RutHelper",function(a){"ngInject";return{require:"ngModel",restrict:"A",scope:{ngModel:"="},link:function(b,c,d,e){function f(b){return e.$isEmpty(b)?!1:a.validar(b)}c.on("change",function(){var b=a.formatearFull(e.$viewValue,!1);e.$setViewValue(b),c.val(b)}),e.$validators.validateRut=function(b){return f(a.formatearFull(b,!1))}}}}]),RouterCiudadano.$inject=["$stateProvider"],angular.module("router-citizen",["ngRoute","ui.router"]).config(RouterCiudadano),RouterInstitucional.$inject=["$stateProvider"],angular.module("router-institutional",["ngRoute","ui.router"]).config(RouterInstitucional),angular.module("claveunica").run(["$templateCache",function(a){a.put("views/citizen/about.html",'<section id="claveUnica">\n  <div class="container">\n    <img src="../images/infografia.22ab56ac.png" class="img-responsive">\n  </div>\n</section>'),a.put("views/citizen/activate.html",'<section id="activar">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <h1>Activar mi Claveúnica</h1>\n        <h2>Para tener una Claveúnica debes solicitar un código de activación.</h2>\n      </div>\n    </div>\n\n    <div class="row">\n\n      <div class="col-md-6" ng-if="logged === true">\n        <form name="form" class="caja" novalidate style="text-align: center">\n          <h4>Ya estás autenticado</h4>\n          <p>Para ingresar un código y activar una cuenta de Claveúnica primero debes <b>Cerrar sesión</b>.</p>\n        </form>\n      </div>\n      <div class="col-md-6" ng-if="logged === false">\n        <form name="form" class="caja" novalidate>\n          <h4>Ingresa tu RUN y código de activación</h4>\n\n          <div class="form-group" show-errors>\n            <input ng-model="user.numero" name="run" class="form-control" placeholder="RUN" required validate-rut>\n            <p style="padding: 2px; margin: 1px; text-align: justify">Ejemplo: 11.111.111-1</p>\n            <p ng-messages="form.run.$error" ng-if="form.run.$touched" class="text-danger">\n              <span ng-message="required">Debes completar esta información</span>\n              <span ng-message="validateRut">El RUN no es válido</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input ng-model="user.code_activation" name="code" id="activation_code" class="form-control" placeholder="Código de activación" required>\n            <p ng-messages="form.code.$error" ng-if="form.code.$touched" class="text-danger">\n              <span ng-message="required">Debes completar esta información</span>\n            </p>\n            <p style="padding: 2px; margin: 1px; text-align: justify">\n            Si el <b>código de activación</b> es invalido o esta bloqueado puedes solicitar un nuevo <a ui-sref="citizen.recovery.form">aquí</a>\n            </p>\n          </div>\n\n          <div class="checkbox">\n            <label>\n              <input ng-model="confirm" type="checkbox" name="confirm" required>\n              Acepto los <a ui-sref="tos" target="_blank" data-toggle="modal" data-target="#myModal"> Términos y condiciones de uso</a>\n            </label>\n            <p ng-messages="form.confirm.$error" ng-if="form.confirm.$dirty" class="text-danger">\n              <span ng-message="required">Debes aceptar las condiciones de uso</span>\n            </p>\n          </div>\n\n          <p ng-show="message" class="alert alert-danger" ng-bind-html="message"></p>\n\n          <div class="centrado">\n            <button promise-btn class="btn btn-primary" ng-disabled="!confirm || form.$invalid" ng-click="activate(user)">Continuar</button>\n          </div>\n\n        </form>\n      </div>\n\n      <div class="col-md-6">\n        <h4>¿Qué es el código de activación?</h4>\n        <p>Puedes solicitar tu código de activación en las <a href="http://claveunica.gob.cl/oficinas">oficinas</a> del Registro Civil o IPS. Este código, permitirá activar tu Claveúnica en nuestro sitio Web.\n        <br>\n        <br>\n        A continuación un <strong>ejemplo</strong> del documento que contiene el código de activación:</p>\n          <div class="tarjeta example">\n            <p class="text-center"><strong>Servicio de Registro Civil e Identificación</strong></p>\n            <p class="pull-right"><strong>Nro. Atención: 123456</strong></p>\n            <p class="text-center bajo"><strong>Comprobante</strong></p>\n            <p class="text-center"><strong>CÓDIGO DE ACTIVACIÓN</strong></p>\n            <p class="text-center">ABCDEF</p>\n            <p class="small">Para activar tu ClaveÚnica, ingrese a nuestro sitio <a href="claveunica.gob.cl" target="_blank"><strong>claveunica.gob.cl</strong></a> y haz clic en <strong>ACTIVAR CLAVEÚNICA</strong></p>\n            <p class="small">Este código permite crear su ClaveÚnica para efectuar trámites en línea.</p>\n          </div>\n      </div>\n    </div>\n  </div>\n</section>\n\n<!-- Modal -->\n<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">\n  <div class="modal-dialog" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n      </div>\n      <div class="modal-body">\n        <h1>TÉRMINOS Y CONDICIONES DE CLAVEÚNICA.</h1>\n        <p><strong>I.  BIENVENIDA.</strong></p>\n        <p>Muchas gracias por visitar nuestro sitio web y hacer uso de ClaveÚnica.</p>\n        <p>La presente página contiene información acerca de los Términos y Condiciones de uso bajo los que se rige esta plataforma. Es muy importante que se tome todo el tiempo que sea necesario para leer atentamente el contenido de estos términos y condiciones puesto que usted luego se regirá por los términos aquí establecidos para que haga un uso informado de Claveúnica.</p>\n        <p><strong>II.   ACEPTACIÓN DE LOS TÉRMINOS Y CONDICIONES DE CLAVEÚNICA.</strong></p>\n        <p>Para activar la Claveúnica se requerirá que seleccione la casilla “Acepto los términos y condiciones de uso” en la página de activación. Usted podrá proseguir el proceso en línea únicamente si acepta los términos y condiciones.</p>\n        <p>En caso de que usted no esté de acuerdo con tales términos y políticas, usted no puede utilizar este medio. </p>\n        <p><strong>III.  SOBRE CLAVEÚNICA. </strong></p>\n        <p><strong>1.</strong>  ¿Qué es la autenticación única y para qué servirá?</p>\n        <p>Este sistema permitirá a los ciudadanos acceder con una contraseña única a los servicios en línea de diversas instituciones. </p>\n        <p><strong>2.</strong>   ¿Cómo se obtiene la Claveúnica? </p>\n        Todos los personas usuarias del Registro Civil mayores de 14 años pueden obtener esta clave. Para obtener la contraseña, es necesario realizar tres simples pasos:\n        <p>(a) Dirigirse al Servicio de Registro Civil e Identificación o cualquiera de los sitios habilitados para la entrega de Claveúnica con el carnet de identidad, donde le harán entrega de un comprobante correspondiente al “Código de Activación de Cuenta en Oficina Internet”.</p>\n        <p>(b) Posteriormente, ingresar al sitio web https://claveunica.gob.cl/activar o al link indicado en el correo electrónico que se envía al momento de la solicitud, donde se le solicitará digitar el número de su Carnet de Identidad (RUN) y el “Código de Activación” disponible en el comprobante. </p>\n        <p>(c) Finalmente, se abrirá una ventana en la cual aparecerá su nombre completo y se le solicitará ingresar una contraseña, que debe contener al menos 8 caracteres, confirmar el correo electrónico y la opción de ingresar un teléfono como medio de recuperación de la contraseña.</p>\n        <p><strong>3.</strong>   ¿Quién opera ClaveÚnica? </p>\n        <p>\n        El Ministerio Secretaría General de la Presidencia (en adelante, el “Ministerio”) opera ClaveÚnica a través de una solución tecnológica (End-Point OpenID Connect) y una plataforma para la administración de los datos de la Claveúnica de los ciudadanos que la utilizan. Es importante señalar que la contraseña personal nunca está en conocimiento de ninguna de las partes intervinientes, sólo de las personas usuarias. </p>\n        <p><strong>4.</strong>  Sobre la utilización de ClaveÚnica.</p>\n        <p>Al aceptar los presentes términos usted declara entender y aceptar lo siguiente:</p>\n        <p>(a) Que el sistema no puede asegurar 100% de disponibilidad, por lo que usted acepta que el sistema puede estar fuera de servicio debido a problemas técnicos. El Ministerio hará todos los esfuerzos razonables que sean necesarios para evitar esta clase de contingencias. No obstante, usted al aceptar estos términos entiende que esta clase de inconvenientes son técnicamente inevitables.</p>\n        <p>(b) En consecuencia, este sistema es proporcionado por Ministerio "tal cual". En consecuencia, no se otorga ninguna garantía expresa o implícita. En ningún caso el Ministerio será responsable por daños directos, indirectos, incidentales, especiales, ejemplar o consecuenciales (incluyendo, pero no limitado a, la adquisición de bienes o servicios; pérdida de uso, de datos o de beneficios, o interrupción de la actividad), y en cualquier teoría de responsabilidad, ya sea en materia de responsabilidad contractual o extracontractual que de alguna manera pueda surgir del uso de este programa computacional, incluso si se ha advertido de la posibilidad de tales daños.</p>\n        <p>(c) El Ministerio sólo provee el servicio de autenticación de las personas. Ello, no obstante, no asegura el mal uso de las claves que se le han entregado a las personas o de los sistemas computacionales que dichas personas han accedido a través dicho medio de autenticación. En consecuencia, el Ministerio no se hace responsable por el uso que las personas den a dicha clave. El uso correcto  de la clave es responsabilidad de las personas.</p>\n        <p>(d) El Ministerio no es responsable acerca de la actualización de los datos personales de las personas que hagan uso de las plataformas electrónicas que son accedidas a través de ClaveÚnica.</p>\n        <p><strong>5.</strong>  Sobre la modificación de estos Términos y Condiciones.</p>\n        <p>Usted al aceptar estos términos faculta al Ministerio para modificar los presentes términos y condiciones. En consecuencia, usted se obliga a revisar periódicamente estos términos.</p>\n\n      </div>\n\n      <div class="modal-footer">\n        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>\n      </div>\n    </div>\n  </div>\n</div>'),a.put("views/citizen/activate_mini.html",'<script>\n  $("footer").remove();\n  $(".barra-superior").remove();\n  $(".tarjeta").parents()[0].remove();\n  $("#bs-navbar").remove();\n  $(".navbar-toggle").remove();\n</script>\n\n<section id="activar">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <a class="btn btn-danger pull-right" href="https://facilita.ipsenlinea.cl/Certificados/facilita/registro-personas.jsf">Salir</a>\n        <h1>Activar mi Claveúnica</h1>\n        <h2>Para tener una Claveúnica debes solicitar un código de activación.</h2>\n      </div>\n    </div>\n\n    <div class="row">\n\n      <div class="col-md-12">\n        <form name="form" class="caja" novalidate>\n          <h4>Ingresa tu RUN y código de activación</h4>\n\n          <div class="form-group" show-errors>\n            <input ng-model="user.numero" name="run" class="form-control" placeholder="RUN" required validate-rut>\n            <small>Ejemplo: 11.111.111-1</small>\n            <p ng-messages="form.run.$error" ng-if="form.run.$touched" class="text-danger">\n              <span ng-message="required">Debes completar esta información</span>\n              <span ng-message="validateRut">El RUN no es válido</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input ng-model="user.code_activation" name="code" class="form-control" placeholder="Código de activación" required>\n            <p ng-messages="form.code.$error" ng-if="form.code.$touched" class="text-danger">\n              <span ng-message="required">Debes completar esta información</span>\n            </p>\n          </div>\n\n          <div class="checkbox">\n            <label>\n              <input ng-model="confirm" type="checkbox" name="confirm" required>\n              Acepto los <a ui-sref="tos" target="_blank" data-toggle="modal" data-target="#myModal"> Términos y condiciones de uso</a>\n            </label>\n            <p ng-messages="form.confirm.$error" ng-if="form.confirm.$dirty" class="text-danger">\n              <span ng-message="required">Debes aceptar las condiciones de uso</span>\n            </p>\n          </div>\n\n          <p ng-show="message" class="alert alert-danger" ng-bind-html="message"></p>\n\n          <div class="centrado">\n            <button promise-btn class="btn btn-primary" ng-disabled="!confirm || form.$invalid" ng-click="activate(user)">Continuar</button>\n          </div>\n\n        </form>\n      </div>\n\n      <div class="col-md-12">\n        <h4>¿Qué es el código de activación?</h4>\n        <p>Puedes solicitar tu código de activación en las oficinas del Registro Civil o en los IPS.<br>\n          Este código, permitirá activar tu Claveúnica en nuestro sitio Web.</p>\n          <div class="tarjeta">\n            <p class="text-center"><strong>Servicio de Registro Civil e Identificación</strong></p>\n            <p class="pull-right"><strong>Nro. Atención: 123456</strong></p>\n            <p class="text-center bajo"><strong>Comprobante</strong></p>\n            <p class="text-center"><strong>CÓDIGO DE ACTIVACIÓN</strong></p>\n            <p class="text-center">ABCDEF</p>\n            <p class="small">Para activar tu ClaveÚnica, ingrese a nuestro sitio <a href="claveunica.gob.cl" target="_blank"><strong>claveunica.gob.cl</strong></a> y haz clic en <strong>ACTIVAR CLAVEÚNICA</strong></p>\n            <p class="small">Este código permite crear su ClaveÚnica para efectuar trámites en línea.</p>\n          </div>\n      </div>\n    </div>\n  </div>\n</section>\n\n<!-- Modal -->\n<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">\n  <div class="modal-dialog" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n      </div>\n      <div class="modal-body">\n        <h1>TÉRMINOS Y CONDICIONES DE CLAVEÚNICA.</h1>\n        <p><strong>I.  BIENVENIDA.</strong></p>\n        <p>Muchas gracias por visitar nuestro sitio web y hacer uso de ClaveÚnica.</p>\n        <p>La presente página contiene información acerca de los Términos y Condiciones de uso bajo los que se rige esta plataforma. Es muy importante que se tome todo el tiempo que sea necesario para leer atentamente el contenido de estos términos y condiciones puesto que usted luego se regirá por los términos aquí establecidos para que haga un uso informado de Claveúnica.</p>\n        <p><strong>II.   ACEPTACIÓN DE LOS TÉRMINOS Y CONDICIONES DE CLAVEÚNICA.</strong></p>\n        <p>Para activar la Claveúnica se requerirá que seleccione la casilla “Acepto los términos y condiciones de uso” en la página de activación. Usted podrá proseguir el proceso en línea únicamente si acepta los términos y condiciones.</p>\n        <p>En caso de que usted no esté de acuerdo con tales términos y políticas, usted no puede utilizar este medio. </p>\n        <p><strong>III.  SOBRE CLAVEÚNICA. </strong></p>\n        <p><strong>1.</strong>  ¿Qué es la autenticación única y para qué servirá?</p>\n        <p>Este sistema permitirá a los ciudadanos acceder con una contraseña única a los servicios en línea de diversas instituciones. </p>\n        <p><strong>2.</strong>   ¿Cómo se obtiene la Claveúnica? </p>\n        Todos los personas usuarias del Registro Civil mayores de 14 años pueden obtener esta clave. Para obtener la contraseña, es necesario realizar tres simples pasos:\n        <p>(a) Dirigirse al Servicio de Registro Civil e Identificación o cualquiera de los sitios habilitados para la entrega de Claveúnica con el carnet de identidad, donde le harán entrega de un comprobante correspondiente al “Código de Activación de Cuenta en Oficina Internet”.</p>\n        <p>(b) Posteriormente, ingresar al sitio web https://claveunica.gob.cl/activar o al link indicado en el correo electrónico que se envía al momento de la solicitud, donde se le solicitará digitar el número de su Carnet de Identidad (RUN) y el “Código de Activación” disponible en el comprobante. </p>\n        <p>(c) Finalmente, se abrirá una ventana en la cual aparecerá su nombre completo y se le solicitará ingresar una contraseña, que debe contener al menos 8 caracteres, confirmar el correo electrónico y la opción de ingresar un teléfono como medio de recuperación de la contraseña.</p>\n        <p><strong>3.</strong>   ¿Quién opera ClaveÚnica? </p>\n        <p>\n        El Ministerio Secretaría General de la Presidencia (en adelante, el “Ministerio”) opera ClaveÚnica a través de una solución tecnológica (End-Point OpenID Connect) y una plataforma para la administración de los datos de la Claveúnica de los ciudadanos que la utilizan. Es importante señalar que la contraseña personal nunca está en conocimiento de ninguna de las partes intervinientes, sólo de las personas usuarias. </p>\n        <p><strong>4.</strong>  Sobre la utilización de ClaveÚnica.</p>\n        <p>Al aceptar los presentes términos usted declara entender y aceptar lo siguiente:</p>\n        <p>(a) Que el sistema no puede asegurar 100% de disponibilidad, por lo que usted acepta que el sistema puede estar fuera de servicio debido a problemas técnicos. El Ministerio hará todos los esfuerzos razonables que sean necesarios para evitar esta clase de contingencias. No obstante, usted al aceptar estos términos entiende que esta clase de inconvenientes son técnicamente inevitables.</p>\n        <p>(b) En consecuencia, este sistema es proporcionado por Ministerio "tal cual". En consecuencia, no se otorga ninguna garantía expresa o implícita. En ningún caso el Ministerio será responsable por daños directos, indirectos, incidentales, especiales, ejemplar o consecuenciales (incluyendo, pero no limitado a, la adquisición de bienes o servicios; pérdida de uso, de datos o de beneficios, o interrupción de la actividad), y en cualquier teoría de responsabilidad, ya sea en materia de responsabilidad contractual o extracontractual que de alguna manera pueda surgir del uso de este programa computacional, incluso si se ha advertido de la posibilidad de tales daños.</p>\n        <p>(c) El Ministerio sólo provee el servicio de autenticación de las personas. Ello, no obstante, no asegura el mal uso de las claves que se le han entregado a las personas o de los sistemas computacionales que dichas personas han accedido a través dicho medio de autenticación. En consecuencia, el Ministerio no se hace responsable por el uso que las personas den a dicha clave. El uso correcto  de la clave es responsabilidad de las personas.</p>\n        <p>(d) El Ministerio no es responsable acerca de la actualización de los datos personales de las personas que hagan uso de las plataformas electrónicas que son accedidas a través de ClaveÚnica.</p>\n        <p><strong>5.</strong>  Sobre la modificación de estos Términos y Condiciones.</p>\n        <p>Usted al aceptar estos términos faculta al Ministerio para modificar los presentes términos y condiciones. En consecuencia, usted se obliga a revisar periódicamente estos términos.</p>\n\n      </div>\n\n      <div class="modal-footer">\n        <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>\n      </div>\n    </div>\n  </div>\n</div>'),
a.put("views/citizen/activity.html",'<section id="last-activity">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <h1 class="text-center">Últimos movimientos</h1>\n        <table class="table table-bordered table-striped">\n          <thead>\n            <tr>\n              <th>Operación</th>\n              <th>Institución</th>\n              <th width="10%">Fecha</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr dir-paginate="activity in activities | itemsPerPage: 10">\n              <td>{{ activity.nombreApp }}</td>\n              <td>{{ activity.institucion }}</td>\n              <td><span style="white-space: nowrap">{{ activity.fecha | date: \'dd-MM-yyyy HH:mm:ss\' }}</span></td>\n            </tr>\n            <tr ng-show="!activities.length">\n              <td colspan="3" class="text-center"><h3>Cargando última actividad...</h3></td>\n            </tr>\n          </tbody>\n        </table>\n\n        <nav class="text-center">\n          <dir-pagination-controls></dir-pagination-controls>\n        </nav>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/config.html",'<section id="configurar">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12" ng-if="result === null">\n        <h1>Configurar mis datos</h1>\n\n        <user-form data="data" on-save="modifyData(profile, fullname)">\n        </user-form>\n      </div>\n\n      <div class="col-md-12" ng-show="result === \'success\'">\n        <h1 class="text-center">¡Felicitaciones, ya tienes tu Claveúnica!</h1>\n\n        <div class="alert alert-success">\n          <p class="text-center"><strong>{{ fullname }}</strong> ya cuentas con tu Claveúnica, <br>a partir de ahora podrás utilizarla en distintos servicios e instituciones <br>del Estado. Sólo debes recordar tu contraseña.</p>\n        </div>\n\n        <div ng-controller="TasksController as $ctrl">\n          <h2>Estas son algunas de la operaciones que puedes realizar con tu Claveúnica:</h2>\n\n          <div class="row" style="display: flex; flex-wrap: wrap">\n            <div class="col-sm-4" ng-repeat="tramite in $ctrl.getTasks()" style="display: flex">\n              <div class="tarjeta" style="display: flex; flex-direction: column;width: 100%">\n                <small>{{ tramite.institution_name }}</small>\n                <h4 style="flex: 1">{{ tramite.tramite }}</h4>\n                <div>\n                  <a href="{{ tramite.enlace }}" target="_blank" class="btn btn-info pull-right">Iniciar</a>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-md-12" ng-show="result === \'error\'">\n        <h1 class="text-center">Lo sentimos, ha ocurrido un error.</h1>\n\n        <div class="alert alert-danger">\n          <p class="text-center">Ha ocurrido un error mientras activábamos tu Claveúnica. <br> <a ui-sref="citizen.activation.form">Por favor inténtalo nuevamente.</a> </p>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/configmini.html",'<section id="configurar">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12" ng-if="result === null">\n        <h1>Configurar mis datos mini</h1>\n        <a class="btn btn-danger pull-right" href="https://facilita.ipsenlinea.cl/Certificados/facilita/registro-personas.jsf">Salir</a>\n\n        <user-form data="data" on-save="modifyData(profile, fullname)">\n        </user-form>\n      </div>\n\n      <div class="col-md-12" ng-show="result === \'success\'">\n        <h1 class="text-center">¡Felicitaciones, ya tienes tu Claveúnica!</h1>\n\n        <div class="alert alert-success">\n          <p class="text-center"><strong>{{ fullname }}</strong> ya cuentas con tu Claveúnica, <br>a partir de ahora podrás utilizarla en distintos servicios e instituciones <br>del Estado. Sólo debes recordar tu contraseña.</p>\n        </div>\n\n        <div ng-controller="TasksController as $ctrl" style="text-align: center !important">\n          <a class="btn btn-danger" href="https://facilita.ipsenlinea.cl/Certificados/facilita/registro-personas.jsf">Salir</a>\n        </div>\n      </div>\n\n      <div class="col-md-12" ng-show="result === \'error\'">\n        <h1 class="text-center">Lo sentimos, ha ocurrido un error.</h1>\n\n        <div class="alert alert-danger">\n          <p class="text-center">Ha ocurrido un error mientras activábamos tu Claveúnica. <br> <a ui-sref="citizen.activation.form">Por favor inténtalo nuevamente.</a> </p>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/credentials.html",'<section id="last-activity">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <h1 class="text-center">Mis Credenciales</h1>\n        <table class="table table-bordered table-striped">\n          <thead>\n            <tr>\n              <th></th>\n              <th>client_id</th>\n              <th>client_secret</th>\n              <th>redirect_uri</th>\n              <th style="text-align: right">Options</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td><label class="btn_credentials" style="background-color: #ff9800">Stagging</label></td>\n              <td>123asd231213jkn31j2n31on123</td>\n              <td>n31j21231n31o213jkn1233asd2</td>\n              <td>domain.com/callback_test</td>\n              <td style="text-align: right">\n                <span class="">Editar</span>\n                &nbsp;|&nbsp;\n                <span class="">Eliminar</span>\n              </td>\n            </tr>\n            <tr>\n              <td><label class="btn_credentials" style="background-color: #03a9f4">Production</label></td>\n              <td>123asd231213jkn31j2n31on123</td>\n              <td>n31j21231n31o213jkn1233asd2</td>\n              <td>domain.com/callback</td>\n              <td style="text-align: right">\n                <span class="">Editar</span>\n                &nbsp;|&nbsp;\n                <span class="">Eliminar</span>\n              </td>\n            </tr>\n            <!-- <tr dir-paginate="credential in credentials | itemsPerPage: 10">\n              <td></td>\n              <td></td>\n              <td></td>\n            </tr>\n            <tr ng-show="!activities.length">\n              <td colspan="5" class="text-center"><h3>Cargando credenciales...</h3></td>\n            </tr> -->\n          </tbody>\n        </table>\n\n        <nav class="text-center">\n          <dir-pagination-controls></dir-pagination-controls>\n        </nav>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/faqs.html",'<section id="faqs">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <h1 style="font-family: \'Roboto Slab\'">Preguntas Frecuentes</h1>\n        <h2>Consulta nuestras preguntas y respuestas</h2>\n\n        <div class="alert alert-danger" ng-if="error">\n          Ha ocurrido un error al cargar los datos.\n        </div>\n\n        <div ng-if="!faqs && !error">\n          Cargando preguntas frecuentes...\n        </div>\n\n        <uib-accordion>\n          <div uib-accordion-group class="panel-default" dir-paginate="faq in faqs | itemsPerPage: 10">\n            <uib-accordion-heading>\n              <span class="glyphicon glyphicon-plus"></span>&nbsp;&nbsp;{{ faq.pregunta }}\n            </uib-accordion-heading>\n\n            <div class="panel-collapse in" ng-bind-html="faq.respuesta"></div>\n          </div>\n        </uib-accordion>\n\n        <div class="text-center">\n          <dir-pagination-controls></dir-pagination-controls>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/get-it.html",'<section id="obtener-clave" style="margin-top: 30px">\n  <div class="container">\n    <div class="col-md-12">\n      <h2 style="font-family: \'Roboto Slab\'">¿Cómo se obtiene?</h2>\n    </div>\n    <div class="row">\n      <div class="col-md-6 col-xs-12">\n        <!-- <div class="step arrow_box">Paso 1</div> -->\n        <div id="step-1">\n          <h2 class="text-left" style="color: white !important">\n            <i class="fas fa-map-marker-alt" style="float: left; font-size: 3.5rem; margin-right: 20px; margin-top: -4px"></i> Acércate a las oficinas\n          </h2>\n        </div>\n        <div class="tarjeta" style="border: 2px solid #2b558e !important">\n          <p> Busca la oficina del Registro Civil o IPS/ChileAtiende más cercana y pide tu código de activación.</p>\n          <a ui-sref="citizen.offices" class="btn btn-primary text-center">Buscar</a>\n        </div>\n      </div>\n      <div class="col-md-6 col-xs-12">\n        <!-- <div class="step arrow_box">Paso 2</div> -->\n        <div id="step-2">\n          <h2 class="text-left" style="color: white !important">\n            <i class="fas fa-asterisk" style="float: left; font-size: 3.5rem; margin-right: 16px; margin-top: -4px; margin-left: 4px"></i> Activa tu Claveúnica\n          </h2>\n        </div>\n        <div class="tarjeta" style="border: 2px solid #2b558e !important">\n          <p>Con tu código de activación y tu RUN ya puedes activar tu Claveúnica.<br>&nbsp;</p>\n          <a ui-sref="citizen.activation.form" class="btn btn-primary text-center">Activar</a>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/home.html",'<div id="menu-home">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-4 menu-left">\n        <div class="menu-item"><h2><a ui-sref="citizen.about">¿Sabes qué es?</a></h2></div>\n        <div class="menu-item"><h2><a ui-sref="citizen.tasks">Trámites disponibles</a></h2></div>\n      </div>\n      <div class="col-md-4 nopadding">\n        <div class="menu-item"><h2><a ui-sref="citizen.activation.form">Activa tu clave</a></h2></div>\n        <div class="menu-item"><h2><a ui-sref="citizen.offices">Encuentra oficinas</a></h2></div>\n      </div>\n      <div class="col-md-4 menu-right">\n        <div class="menu-item"><h2><a ui-sref="citizen.recovery.form">Recupera tu Claveúnica</a></h2></div>\n        <div class="menu-item"><h2><a ui-sref="citizen.faqs">¿Necesitas ayuda?</a></h2></div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="container video" style="margin-bottom: 15px">\n  <div class="row">\n    <div class="col-md-5 menu-left">\n      <div class="contenido">\n        <h2 style="font-family: \'Roboto Slab\'; font-weight: 300; color: white">Qué es la Claveúnica</h2>\n        <p>Es una contraseña única para acceder a todos los servicios del Estado, de manera fácil y segura ya que es como tu carnét de identidad digital.</p>\n      </div>\n    </div>\n    <div class="col-md-7 menu-right">\n      <div>\n        <iframe src="https://player.vimeo.com/video/195798539?color=ffffff&title=0&byline=0&portrait=0" width="100%" height="300" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="container">\n  <div class="row">\n    <div class="col-lg-12 col-md-12" id="metrics">\n      <div class="tarjeta metrics_home" style="border-bottom: none !important; background-color: #efefef">\n        <h2 class="col-md-3 text-left">Actualmente contamos con</h2>\n        <div class="col-md-9 row">\n          <div class="col-md-4 col-sm-4 box-number">\n            <span class="number">{{ data.numberUsers | formatPrice }}</span>\n            <span class="description">Ciudadanos activos</span>\n          </div>\n          <div class="col-md-2 col-sm-2 box-number">\n            <span class="number">{{ data.numberInstitutions | formatPrice }}</span>\n            <span class="description">Instituciones</span>\n          </div>\n          <div class="col-md-3 col-sm-4 box-number">\n            <span class="number">{{ data.numberApps | formatPrice }}</span>\n            <span class="description">Trámites</span>\n          </div>\n          <div class="col-md-3 col-sm-4 box-number">\n            <span class="number">{{ data.numberTransactionsDay | formatPrice }}</span>\n            <span class="description">Autenticaciones hoy</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<ng-include src="\'views/citizen/get-it.html\'"></ng-include>'),a.put("views/citizen/index.html","<ui-view></ui-view>"),a.put("views/citizen/login.html",'<script>\n  $("footer").hide();\n  $(".barra-superior").hide();\n  $("#bs-navbar").hide();\n  $(".navbar").hide();\n</script>\n\n<link href="https://claveunica.gob.cl/assets/auth/oidc.css?v1" rel="stylesheet">\n\n<style>\n\n  #formClaveUnica {\n    position: relative;\n    background: #fff;\n    color: #656565;\n    margin-top: 80px;\n  }\n\n  #formClaveUnica .logo img {\n    margin: -2px 13px 0px -7px !important\n  }\n  #formClaveUnica .logo {\n    text-align: center;\n  }\n  .logo {\n    background-color: white;\n    height: 100px;\n  }\n  .#formClaveUnica .logo img{\n    margin: 10px -5px !important;\n  }\n  #formClaveUnica .main input[type=text], #formClaveUnica .main input[type=password] {\n    height: 55px;\n  }\n  #formClaveUnica .alert {\n    padding: 10px !important;\n  }\n\n  .alert {\n    margin-bottom: 10px !important;\n  }\n  .alert-info {\n    background-color: #d9edf7 !important;\n  }\n  .alert-info h2{\n    color: #656565;\n    font-size: 27px;\n    font-weight: 500;\n    margin-bottom: 5px;\n    font-family: inherit;\n  }\n  .alert-info h4{\n    font-size: 1.8rem;\n    font-family: inherit;\n  }\n\n  #formClaveUnica .main .btn {\n    padding: 15px 20px !important;\n  }\n  #formClaveUnica {\n    border-radius: 0px !important;\n  }\n  #formClaveUnica .main label {\n    line-height: 35px !important;\n  }\n\n  @media (min-width: 1200px){\n\n    .col-lg-offset-3 {\n      margin-left: 25%;\n    }\n\n    .col-lg-6 {\n      width: 50%;\n    }\n\n  }\n\n\n  @media (max-width: 767px) {\n      #formClaveUnica {\n          margin: 15px 0 !important;\n      }\n\n      #formClaveUnica .main {\n          margin: 0 15px !important;\n      }\n  }\n\n  @media only screen and (max-width : 480px) {\n      #formClaveUnica .main .btn {\n          padding: 10px !important;\n      }\n  }\n\n  @media only screen and (max-width : 320px) {\n      #formClaveUnica .main .btn {\n          padding: 10px !important;\n          font-size: 18px !important;\n      }\n\n      #formClaveUnica .main label {\n          font-size: 16px !important;\n      }\n  }\n\n</style>\n\n<div class="container">\n  <div class="row">\n    <div class="col-lg-6 col-lg-offset-3 col-md-8 col-md-offset-2 col-sm-10 col-sm-offset-1">\n\n        <div id="formClaveUnica" class="form-horizontal">\n            <form class="form-horizontal" name="form" style="border: 1px solid black; background-color: white; margin-top: 80px; border-radius: 6px">\n                <fieldset>\n                  <!-- <div class=\'ajaxLoader\'>Cargando</div> -->\n                  <div class="logo col-xs-12">\n                    <img src="https://claveunica.gob.cl/assets/auth/img/oidc/logo3x.png" alt="ClaveÚnica" height="80" style="margin-top: 10px !important; margin-left: -75px !important">\n                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Logo_Gobierno_de_Chile_2010-2014.svg/1200px-Logo_Gobierno_de_Chile_2010-2014.svg.png" height="90px" class="pull-left">\n                  </div>\n                  <div class="clearfix"></div>\n\n                  <div class="alert alert-info" style="text-align: center; border: none !important; background-color: #e5e5e5 !important">\n                    <h2 style="font-size: 27px">Portal ClaveÚnica</h2>\n                    <h4>requiere autenticación</h4>\n                  </div>\n\n                  <div id="error-message" style="text-align: center; color: #656565; border: 1px solid transparent; border-color: #cdd5df !important" class="alert alert-danger" ng-show="message" ng-bind-html="message"></div>\n\n                  <user-login-form data="data" on-save="accessUser(user)"></user-login-form>\n    <script>\n      (function(i,s,o,g,r,a,m){i[\'GoogleAnalyticsObject\']=r;i[r]=i[r]||function(){\n      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n'+"      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n      ga('create', 'UA-88247730-1', 'claveunica.gob.cl');\n      ga('send', 'pageview');\n    </script>\n\n    </fieldset></form></div>\n  </div>\n</div></div>"),a.put("views/citizen/offices.html",'<main id="oficinas">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <h1>¿Dónde puedo obtener mi Claveúnica?</h1>\n        <h2>Ingresa una región y comuna y te diremos donde puedes ir </h2>\n      </div>\n    </div>\n  </div>\n  <div class="opacidad">\n    <div class="container">\n      <div class="row">\n        <div class="col-md-12">\n          <form id="office-filter" class="form-inline">\n            <div class="form-group">\n              <button class="form-control" ng-click="getNearOffices()">Oficinas cercanas a mi ubicación actual <i class="fa fa-location-arrow" aria-hidden="true"></i></button>\n            </div>\n            <div class="form-group">\n              <select class="form-control" ng-model="region" ng-disabled="regions.length == 0" ng-options="region as region.nombre for region in regions | orderBy:\'index\'" ng-change="changeRegion(region)">\n                <option value="" disabled selected>Selecciona una región</option>\n              </select>\n            </div>\n            <div class="form-group">\n              <select class="form-control" ng-model="city" ng-disabled="cities.length == 0" ng-options="city as city.nombre for city in cities | orderBy:\'nombre\'" ng-change="getCityOffices(city)">\n                <option value="" disabled selected>Selecciona una comuna</option>\n              </select>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="container clearfix" style="margin-bottom: 15px">\n    <div class="row">\n\n      <!-- <div class="col-md-6">\n        <ui-gmap-google-map center=\'map.center\' zoom=\'map.zoom\' control="control">\n          <ui-gmap-marker ng-repeat="office in offices" coords="office.coordinates" idKey="office.$$hashKey">\n            <ui-gmap-window>\n              <p>{{ office.institution_name}} <br> {{ office.direccion }}</p>\n            </ui-gmap-window>\n          </ui-gmap-marker>\n        </ui-gmap-google-map>\n      </div> -->\n\n      <!-- <div class="col-md-6 scroll-list"> -->\n      <div class="col-md-12 scroll-list">\n        <div class="oficinas hide office-loading-spinner text-center">\n          <img src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/0.16.1/images/loader-large.gif" class="">\n        </div>\n        <div class="oficinas" ng-repeat="office in offices" ng-click="centerMap(office)">\n          <p><strong>{{ office.institution_name }}</strong></p>\n          <p><i class="glyphicon glyphicon-map-marker" aria-hidden="true"></i> {{ office.direccion }}</p>\n          <p ng-show="office.horario.length"><i class="glyphicon glyphicon-time" aria-hidden="true"></i> {{ office.horario }}</p>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</main>'),a.put("views/citizen/profile.html",'<script>\n  $("footer").show();\n  $(".barra-superior").show();\n  $("#bs-navbar").show();\n  $(".navbar").show();\n</script>\n\n<section id="configurar">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12" ng-if="result === null">\n        <h1>Actualizar mis datos</h1>\n\n        <user-form data="data" on-save="modifyData(profile, fullname)">\n        </user-form>\n      </div>\n\n      <div class="col-md-12" ng-show="result === \'success\'">\n        <h1 class="text-center">¡Tus datos han sido actualizados correctamente!</h1>\n\n        <div class="alert alert-success">\n          <p class="text-center"><strong>{{ fullname }}</strong> tus datos han sido actualizados correctamente. <br> <a ui-sref="citizen.profile" ui-sref-opts="{ reload: true }">Volver a edición</a></p>\n        </div>\n      </div>\n\n      <div class="col-md-12" ng-show="result === \'error\'">\n        <h1 class="text-center">Lo sentimos, ha ocurrido un error.</h1>\n\n        <div class="alert alert-danger">\n          <p class="text-center">Ha ocurrido un error mientras guardábamos tus datos. <br> <a ui-sref="citizen.profile" ui-sref-opts="{ reload: true }">Por favor inténtalo nuevamente.</a> </p>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/recovery.html",'<section id="recuperar">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <h1>Recuperar mi Claveúnica</h1>\n        <h2>¿Tienes problemas con el código de activación u olvidaste tu contraseña? Completa estos campos para recuperarla.</h2>\n        <div class="recuadro">\n          <form name="form" novalidate>\n            <div class="row">\n              <div class="col-md-offset-2 col-md-8 col-md-offset-2">\n                <div class="pass-box">\n                  <h4>Ingresa tu RUN</h4>\n                  <div class="form-group" show-errors>\n                    <input name="run" ng-model="run" class="form-control" placeholder="RUN" validate-rut required>\n                    <small>Ejemplo: 11.111.111-1</small>\n                    <p ng-messages="form.run.$error" ng-if="form.run.$touched" class="text-danger">\n                      <span ng-message="required">Debes completar esta información</span>\n                      <span ng-message="validateRut">El RUN no es válido</span>\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class="row" ng-show="form.run.$valid">\n              <div class="col-md-offset-2 col-md-8 col-md-offset-2">\n                <div class="pass-box">\n                  <h4>Valida que no eres un robot</h4>\n                  <div ng-model="captcha" vc-recaptcha on-success="isHuman(response)" on-expire="resetForm()"></div>\n                </div>\n              </div>\n            </div>\n\n            <div class="row" ng-show="showOptions(form)" ng-disabled="apiError">\n              <div class="col-md-offset-2 col-md-8 col-md-offset-2">\n                <div ng-show="methods.length == 2" class="pass-box">\n                  <h4>A continuación, escoge un método para recuperar tu Claveúnica.</h4>\n                  <div class="text-center">\n                    <button promise-btn ng-click="sendRecovery(1)" class="btn btn-primary" ng-disabled="apiError">Correo electrónico</button>\n                    <button promise-btn ng-click="sendRecovery(2)" class="btn btn-primary" ng-disabled="apiError">Celular</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div class="row" ng-switch="apiError" ng-if="apiError">\n              <div class="col-md-offset-2 col-md-8 col-md-offset-2">\n                <div class="pass-box text-center">\n                  <div class="alert alert-success">\n                    <p ng-bind-html="message"></p>\n                    <br> \n                  </div>\n                </div>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/citizen/tasks.html",'<section id="task-filter">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <h1 style="font-family: \'Roboto Slab\'">¿Dónde puedo utilizar mi Claveúnica?</h1>\n        <h2>Aquí puedes encontrar operaciones disponibles con tu Claveúnica</h2>\n      </div>\n    </div>\n  </div>\n  <div class="row opacidad">\n    <div class="container">\n      <div class="row">\n        <div class="col-md-12">\n          <form class="form-inline">\n            <div class="form-group">\n              <select class="form-control" ng-model="service" ng-options="service as service.nombre for service in services" ng-change="changeService(service)" id="filter-by">\n                <option value="" selected>Todas las instituciones</option>\n              </select>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>\n<section id="tasks">\n  <div class="container" ng-init="getTasks()">\n    <h5 class="text-center" ng-hide="tasks.length">Cargando operaciones disponibles...</h5>\n    <div class="row" style="display: flex; flex-wrap: wrap">\n      <div class="col-sm-4" dir-paginate="tramite in tasks | itemsPerPage: 12" style="display: flex">\n        <div class="tarjeta" style="width: 100%">\n          <small>{{ tramite.institution_name }}</small>\n          <h4 style="flex: 1">{{ tramite.tramite }}</h4>\n          <div>\n            <a href="{{ tramite.enlace }}" ng-disabled="!tramite.enlace.length" target="_blank" class="btn btn-primary pull-right" style="position: absolute; bottom: 0px; margin-bottom: 30px; right: 20px">Iniciar</a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="text-center clearfix">\n      <dir-pagination-controls></dir-pagination-controls>\n    </div>\n\n  </div>\n</section>'),a.put("views/citizen/tos.html",'<section id="tos">\n  <div class="container">\n    <div class="row">\n      <div class="col-md-12">\n    <h1>Términos y Condiciones</h1>\n    <h2>Lorem ipsum dolor</h2>\n    <p>La <strong>ClaveÚnica</strong> registrada por el usuario(a) debe ser única, personal, confidencial e intransferible.\nSu duración es indefinida, sin perjuicio de su actualización periódica voluntaria o solicitada por el Registro Civil.</p>\n    <p>Todo uso del <strong>nombre de usuario(a) y ClaveÚnica</strong> es de única y exclusiva responsabilidad del titular.</p>\n    <p>El usuario(a) declara comprometerse a adoptar todas las medidas para que el <strong>nombre de usuario(a) y ClaveÚnica</strong> no sean conocidos, entregados, utilizados por terceras personas autorizadas o no, divulgados, publicados, cedidos o cualquiera otra acción que suponga un uso indebido de dicha información de carácter personal, confidencial e intransferible.</p>\n    <p>En el caso que la persona acceda al sitio Web <a href="http://www.claveunica.gob.cl" target="_blank">www.claveunica.gob.cl</a>, con su nombre de usuario(a) y ClaveÚnica, la responsabilidad derivada de la falta de cuidado, indebida reserva, mal uso o uso por terceros autorizados o no, ocasionándose o no perjuicios directos previstos e imprevistos, o de cualquier otra especie, es exclusiva responsabilidad del titular.</p>\n    <p>El Servicio de Registro Civil e identificación empleará los medios tecnológicos disponibles actualmente para la entrega de los certificados, sin perjuicio de las adecuaciones que pudieran efectuarse en el futuro.</p>\n    </div>\n    </div>\n  </div>\n</section>'),a.put("views/components/dashboard-chart.html",'<h2 class="text-center">{{ $ctrl.title }}</h2>\n<h3 class="text-center">{{ $ctrl.filters[$ctrl.selected] }} </h3>\n\n<div class="chart-filters text-right">\n  <form class="form-inline">\n    <div class="form-group">\n      <label>Ver desde:\n        <select class="form-control" ng-model="$ctrl.selected" ng-change="$ctrl.changeFilter($ctrl.selected)" ng-options="$ctrl.filters.indexOf(selected) as selected for selected in $ctrl.filters">\n        </select>\n      </label>\n    </div>\n  </form>\n</div>\n\n<div class="chart-display" style="background: #ffffff">\n  <nvd3 options="$ctrl.options" data="$ctrl.data"></nvd3>\n</div>'),a.put("views/components/user-button.html",'<button type="button" class="btn btn-primary dropdown-toggle boton-header" ng-class="$ctrl.isMobile ? \'visible-xs visible-sm\' : \'\'" data-toggle="dropdown" style="padding-right: 10px !important; border-bottom: none !important">\n  <span class="hidden-xs"><strong>mi</strong> claveúnica</span>\n  <span>{{ $ctrl.fullName }}</span>\n  <i class="fas fa-caret-down hidden-xs"></i>\n</button>\n\n<ul class="dropdown-menu hidden-xs" ng-hide="$ctrl.loggedIn" onmouseover="paintButtonMenu()" style="margin-top: -20px">\n  <li><a ui-sref="citizen.activation.form">Activa tu Claveúnica</a></li>\n  <li><a ui-sref="citizen.recovery.form">Recupera tu Claveúnica</a></li>\n  <li><a ng-click="$ctrl.login(\'citizen.profile\')" style="cursor: pointer">Actualiza tus datos</a></li>\n  <li><a ng-click="$ctrl.login(\'citizen.activity\')" style="cursor: pointer">Revisa tu última actividad</a></li>\n</ul>\n\n<ul class="dropdown-menu hidden-xs" ng-show="$ctrl.loggedIn" onmouseover="paintButtonMenu()" style="margin-top: -20px">\n  <li><a ui-sref="citizen.profile">Actualizar mis datos</a></li>\n  <li><a ui-sref="citizen.activity">Últimos movimientos</a></li>\n  <!-- <li><a ui-sref="citizen.credentials">Mis credenciales</a></li> -->\n  <li ng-if="institution"><a ui-sref="institutional.charts">Estadísticas institucionales</a></li>\n  <li><a ng-click="$ctrl.logout()" style="cursor: pointer">Cerrar sesión</a></li>\n</ul>\n\n<ul class="mobile_menu visible-xs" ng-hide="$ctrl.loggedIn" onmouseover="paintButtonMenu()" style="margin-top: -20px">\n  <li><a ui-sref="citizen.activation.form">Activa tu Claveúnica</a></li>\n  <li><a ui-sref="citizen.recovery.form">Recupera tu Claveúnica</a></li>\n  <li><a ng-click="$ctrl.login(\'citizen.profile\')" style="cursor: pointer">Actualiza tus datos</a></li>\n  <li><a ng-click="$ctrl.login(\'citizen.activity\')" style="cursor: pointer">Revisa tu última actividad</a></li>\n</ul>\n\n<ul class="mobile_menu visible-xs" ng-show="$ctrl.loggedIn" onmouseover="paintButtonMenu()" style="margin-top: -20px">\n  <li><a ui-sref="citizen.profile">Actualizar mis datos</a></li>\n  <li><a ui-sref="citizen.activity">Últimos movimientos</a></li>\n  <!-- <li><a ui-sref="citizen.credentials">Mis credenciales</a></li> -->\n  <li ng-if="institution"><a ui-sref="institutional.charts">Estadísticas institucionales</a></li>\n  <li><a ng-click="$ctrl.logout()" style="cursor: pointer">Cerrar sesión</a></li>\n</ul>'),a.put("views/components/user-form.html",'<h3 ng-show="!$ctrl.fullName" class="text-center">\n  Cargando datos...\n</h3>\n\n<div ng-show="$ctrl.fullName">\n  <h2>Hola, {{ $ctrl.getFullName($ctrl.data) }}</h2>\n\n  <div class="datos">\n    <form name="form" novalidate>\n      <div class="contraseña">\n        <h4>Crea una contraseña para tu claveúnica</h4>\n\n        <div class="form-group" show-errors>\n          <div class="input-group">\n            <input ng-model="$ctrl.password" ng-model-options="{ allowInvalid: $ctrl.allowInvalid }" strong-pass type="{{ $ctrl.showPassword[0] ? \'text\' : \'password\' }}" name="pwd" class="form-control" placeholder="Ingresa tu contraseña *" required>\n\n            <span class="input-group-btn">\n              <button class="btn btn-default" type="button" ng-click="$ctrl.togglePassword(0)">\n                <span class="glyphicon glyphicon-eye-open"></span>\n              </button>\n            </span>\n          </div>\n          <small>Debe contener al menos 8 caracteres y contar con <strong>letras mayúsculas, minúsculas y números</strong> (puedes agregar símbolos para mayor seguridad).</small>\n\n          <p ng-messages="form.pwd.$error" class="text-danger" ng-if="form.pwd.$dirty">\n            <span ng-message="invalidchar">La contraseña contiene símbolos no permitidos (<span ng-bind="$ctrl.pswdInvalidChars()"></span>)</span>\n            <span ng-message="required">Este campo es obligatorio</span>\n            <span ng-message="strongPassword">La contraseña es inválida</span>\n          </p>\n        </div>\n\n        <div class="form-group" show-errors>\n          <div class="input-group">\n            <input ng-model="$ctrl.password_confirm" ng-paste="$event.preventDefault()" compare-to="$ctrl.password" name="pwdconfirm" type="{{ $ctrl.showPassword[1] ? \'text\' : \'password\' }}" class="form-control" placeholder="Reingresa tu contraseña *">\n\n            <span class="input-group-btn">\n              <button class="btn btn-default" ng-click="$ctrl.togglePassword(1)">\n                <span class="glyphicon glyphicon-eye-open"></span>\n              </button>\n            </span>\n          </div>\n          <small>Por favor repite tu contraseña para evitar errores.</small>\n\n          <p ng-messages="form.pwdconfirm.$error" class="text-danger" ng-if="form.pwdconfirm.$dirty">\n            <span ng-message="required">Este campo es obligatorio</span>\n            <span ng-message="compareTo">Las contraseñas no coinciden</span>\n          </p>\n        </div>\n      </div>\n\n      <div class="correo">\n        <h4>Indica tu correo electrónico</h4>\n        <p>El correo electrónico que indiques será usado para recuperar tu contraseña y para enviarte información relevante.</p>\n\n        <div class="form-group" show-errors>\n          <input ng-model="$ctrl.email" type="email" name="email" class="form-control" placeholder="Ingresa tu correo electrónico *" required>\n          <small>Ejemplo: correo@chile.cl</small>\n\n          <p ng-messages="form.email.$error" class="text-danger" ng-if="!form.email.$valid">\n            <span ng-message="required">Este campo es obligatorio</span>\n            <span ng-message="email">El correo electrónico no es válido</span>\n          </p>\n        </div>\n\n        <div class="form-group" show-errors>\n          <input ng-model="$ctrl.email_confirm" ng-paste="$event.preventDefault()" compare-to="$ctrl.email" type="email" name="email_confirm" class="form-control" placeholder="Vuelve a ingresar tu correo electrónico *" required>\n          <small>Por favor repite tu correo electrónico para evitar errores.</small>\n\n          <p ng-messages="form.email_confirm.$error" class="text-danger" ng-if="!form.email_confirm.$valid">\n            <span ng-message="required">Este campo es obligatorio</span>\n            <span ng-message="compareTo">Los correos electrónicos no coinciden</span>\n          </p>\n        </div>\n      </div>\n\n      <div class="telefono">\n        <h4>Número de celular</h4>\n\n        <p>El número de celular que indiques también podrá ser usado para recuperar tu contraseña y para enviarte información relevante.</p>\n        <div class="input-group" show-errors>\n          <div class="row">\n            <div class="col-sm-4 col-md-4 col-lg-4">\n            <span class="form-control" country-code-select ng-model="$ctrl.code">\n            </span>\n            </div>\n            <div class="col-sm-8 col-md-8 col-lg-8">\n              <input ng-model="$ctrl.phone" ng-pattern="/^[0-9]{4,14}$/" type="tel" name="tel" ng-minlength="9" ng-maxlength="9" class="form-control" placeholder="Ingresa tu número celular">\n                 <small>&nbsp;Ejemplo <b>912345678</b></small>\n            </div>\n          </div>        \n        </div>\n\n        <div class="input-group" show-errors>\n          <div class="row">\n            <div class="col-sm-4 col-md-4 col-lg-4">\n            <span class="form-control" country-code-select name="confirm_code" compare-to="$ctrl.code" ng-model="$ctrl.code_confirm">\n            </span>\n            </div>\n            <div class="col-sm-8 col-md-8 col-lg-8">\n              <input ng-model="$ctrl.phone_confirm" compare-to="$ctrl.phone" ng-paste="$event.preventDefault()" type="tel" name="tel_confirm" class="form-control" placeholder="Reingresa tu número celular">\n              <small>&nbsp;Por favor repite tu número celular para evitar errores.</small>\n            </div>\n          </div>\n        </div>\n\n        <p ng-messages="form.tel_confirm.$error" class="text-danger" ng-if="!form.tel_confirm.$valid">\n          <span ng-message="compareTo">Los números celulares deben ser igual y tener 9 digitos</span>\n        </p>\n\n        <p ng-messages="form.confirm_code.$error" class="text-danger" ng-if="!form.confirm_code.$valid">\n          <span ng-message="compareTo">Los códigos de país no coinciden</span>\n        </p>\n\n        <div class="text-center" style="margin-top: 20px !important">\n\n        <div>\n          <div class="alert alert-info fade in alert-dismissable">\n            Si ocurre un problema favor intentar en otro navegador como <b>Google Chrome</b> o <b>Mozilla Firefox</b>\n          </div>\n        </div>\n\n          <button promise-btn class="btn btn-primary" ng-click="$ctrl.save()" ng-disabled="!form.$valid">Guardar</button>\n        </div>\n      </div>\n\n    </form>\n  </div>\n</div>'),
a.put("views/components/user-login-form.html",'<div class="row">\n        <div class="col-sm-offset-2 col-sm-8">\n          <div class="main">\n\n            <div class="form-group">\n              <label class="col-xs-12 control-label" for="inputUsuario" style="text-align: left">RUN</label>\n                <div class="col-xs-12">\n                  <input ng-model="user.run" name="run" type="text" class="form-control rut" placeholder="RUN" required validate-rut placeholder="Ej: 12345678-9">\n                </div>\n                <p ng-messages="form.run.$error" ng-if="form.run.$touched" class="text-danger">\n                  <span ng-message="required">Debes completar esta información</span>\n                  <span ng-message="validateRut">El RUN no es válido</span>\n                </p>\n            </div>\n\n            <div class="form-group">\n              <label class="col-xs-12 control-label" for="inputPassword" style="text-align: left">Tu ClaveÚnica</label>\n              <div class="col-xs-12">\n                  <input ng-model="user.password" name="password" type="password" class="form-control" placeholder="Contraseña" required>\n                  <a class="recovery" href="https://claveunica.gob.cl/#/recuperar"> ¿Olvidaste tu ClaveÚnica?</a>\n              </div>\n              <p ng-messages="form.code.$error" ng-if="form.code.$touched" class="text-danger">\n              <span ng-message="required">Debes completar esta información</span>\n              </p>\n            </div>\n\n            <div class="form-group" style="margin-top: 30px">\n              <div class="col-xs-12" style="text-align: right">\n                  <button promise-btn class="btn btn-primary" ng-disabled="form.$invalid" ng-click="$ctrl.save(user)">Autenticar</button>\n                  <button class="btn" onclick="location.href=\'claveunica.gob.cl\'" type="button" style="background-color: silver; color: #656565">Cancelar</button>\n              </div>\n            </div>\n\n          </div>\n\n          <div style="padding: 10px 10px 20px 10px; text-align: center">\n            <p>\n              <b>¿No tienes ClaveÚnica?</b> <a href="https://claveunica.gob.cl/como-obtenerla/" target="_blank">Consigue la tuya</a>\n            </p>\n          </div>\n\n        </div>\n      </div>\n\n\n    \n  \n'),a.put("views/footer.html",'<div class="row footer-special" style="background-color: #072651; margin-top: 70px">\n<div class="container">\n  <footer class="footer-gobcl" style="background: none">\n    <div class="banda-bicolor">\n      <span class="azul"></span>\n      <span class="rojo"></span>\n    </div>\n\n    <div class="top">\n        <div class="listas">\n          <div class="lista">\n            <ul>\n              <li><a href="http://www.gob.cl" target="_blank" style="color: white !important">Gobierno de Chile</a></li>\n            </ul>\n          </div>\n          <div class="lista">\n            <ul>\n              <li><a href="https://www.registrocivil.cl/" target="_blank" style="color: white !important">Servicio de Registro Civil e Identificación</a></li>\n            </ul>\n          </div>\n          <div class="lista">\n            <ul>\n              <li><a href="https://digital.gob.cl" target="_blank" style="color: white !important">División de Gobierno Digital</a></li>\n            </ul>\n          </div>\n        </div>\n\n        <!-- <div class="banda-bicolor">\n          <span class="azul"></span>\n          <span class="rojo"></span>\n        </div> -->\n    </div>\n\n    <!-- <div class="sep"></div> -->\n  </footer>\n</div>\n</div>'),a.put("views/header.html",'<nav class="barra-superior">\n  <div class="container">\n\n    <div class="banda-bicolor">\n      <span class="azul"></span>\n      <span class="rojo"></span>\n    </div>\n\n    <ul class="nav navbar-nav" style="float: right !important">\n      <li id="citizen">\n        <a ui-sref="citizen" onclick="location.href=\'/\'" ui-sref-active="active">Ciudadanía</a>\n      </li>\n      <li id="institutional">\n        <a ui-sref="institutional" onclick="location.href=\'/institucional\'" ui-sref-active="active">Instituciones</a>\n      </li>\n    </ul>\n  </div>\n</nav>\n\n<header class="navbar navbar-default" style="background-color: #2c558e; border-radius: 0px !important; box-shadow: none">\n  <div class="container">\n\n    <div class="navbar-header">\n      <button class="collapsed navbar-toggle" data-target="#bs-navbar" data-toggle="collapse" type="button">\n        <span class="sr-only">Toggle navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n      <a ui-sref="citizen.home" class="navbar-brand" style="padding: 0px !important">\n        <img class="img-responsive" src="images/logo-blanco.f981055c.svg" style="height: 40px; padding-right: 4px; margin-top: 20px; margin-left: -2px; margin-bottom: 8px">\n      </a>\n    </div>\n\n    <nav class="collapse navbar-collapse" id="bs-navbar">\n      <ul class="nav navbar-nav menu_1">\n        <li class="li-menu-1" ng-hide="$ctrl.hideCitizenMenu()" ui-sref-active="active"><a ui-sref="citizen.about">¿Qué es?</a></li>\n        <li class="li-menu-1" ng-hide="$ctrl.hideCitizenMenu()" ui-sref-active="active"><a ui-sref="citizen.getit">¿Cómo la obtengo?</a></li>\n        <li class="li-menu-1" ng-hide="$ctrl.hideCitizenMenu()" ui-sref-active="active"><a ui-sref="citizen.tasks">¿Dónde la puedo utilizar?</a></li>\n        <li class="li-menu-1" ng-hide="$ctrl.hideCitizenMenu()" ui-sref-active="active"><a ui-sref="citizen.faqs" style="border-right: 1px solid white !important">Preguntas Frecuentes</a></li>\n\n        <li class="li-menu-1" ng-hide="$ctrl.hideInstitutionMenu()" ui-sref-active="active"><a ui-sref="institutional.how">¿Cómo funciona?</a></li>\n        <li class="li-menu-1" ng-hide="$ctrl.hideInstitutionMenu()" ui-sref-active="active"><a ui-sref="institutional.request">Solicitar activación</a></li>\n        <li class="li-menu-1" ng-hide="$ctrl.hideInstitutionMenu()" ui-sref-active="active"><a ui-sref="institutional.tutorial">Guía técnica</a></li>\n\n        <li class="visible-xs visible-sm dropdown-submenu" ng-hide="$ctrl.isInstitutional()">\n          <user-button is-mobile="true" user="$ctrl.user"></user-button>\n        </li>\n      </ul>\n\n      <div class="pull-right hidden-xs hidden-sm" style="margin-left: -10px" ng-hide="$ctrl.isInstitutional()">\n        <div class="btn-group" role="group">\n          <user-button is-mobile="false" user="$ctrl.user"></user-button>\n        </div>\n      </div>\n    </nav>\n  </div>\n</header>'),a.put("views/institutional/agentes.html",'<script>\nfunction showDiv(div_id) {\n	if ( $("#"+div_id).css(\'display\') == \'none\'){\n		document.getElementById(div_id).style.display = "block";\n	}else{\n		document.getElementById("form_new").reset();\n   		document.getElementById(div_id).style.display = "none";\n	}\n}\n</script>\n\n<section id="how-it-works">\n  <div class="container">\n  	<div class="" style="padding-top: 10px">\n    	<a class="" href="/institucional/soporte">&lt; volver a Soporte</a>\n    </div>\n    <h1 style="margin-bottom: 0px !important">Agentes Soporte</h1> \n    <div class="row">\n      <div class="col-md-12">\n        <button onclick="showDiv(\'form_new_agent\')" class="btn btn-primary" style="font-size: 13px !important">Nuevo</button>\n        <div id="form_new_agent" style="display: none">\n			<form class="form-horizontal" id="form_new" ng-submit="saveAgent()">				\n				<div class="form-group">\n				    <label class="control-label col-sm-2" for="agent_run">RUN</label>\n				    <div class="col-sm-10">\n				    	<input ng-model="agent_run" name="agent_run" required class="form-control ng-pristine ng-isolate-scope ng-empty ng-invalid ng-invalid-validate-rut ng-invalid-required ng-touched" placeholder="Run del Agente (Ej. 11222333-4)" validate-rut="" required>\n				    </div>\n				</div>\n				<div class="form-group">\n				    <label class="control-label col-sm-2" for="agent_name">Nombre</label>\n				    <div class="col-sm-10">\n				    	<input type="text" class="form-control ng-invalid-required" id="agent_name" ng-model="agent_name" name="agent_name" placeholder="" required>\n				    </div>\n				</div>\n				<div class="form-group">\n				    <label class="control-label col-sm-2" for="agent_lastname">Apellido</label>\n				    <div class="col-sm-10">\n				    	<input type="text" class="form-control ng-invalid-required" id="agent_lastname" ng-model="agent_lastname" name="agent_lastname" placeholder="" required>\n				    </div>\n				</div>\n				<div class="form-group">\n				    <label class="control-label col-sm-2" for="agent_email">Email</label>\n				    <div class="col-sm-10">\n				    	<input type="text" class="form-control ng-invalid-required" id="agent_email" ng-model="agent_email" name="agent_email" placeholder="" required>\n				    </div>\n				</div>\n				<div class="form-group">\n				    <label class="control-label col-sm-2" for="agent_phonenumber">Teléfono</label>\n				    <div class="col-sm-10">\n				    	<input type="text" class="form-control ng-invalid-required" id="agent_phonenumber" ng-model="agent_phonenumber" name="agent_phonenumber" placeholder="" required>\n				    	<div>Ej. +56912345678</div>\n				    </div>\n				</div>\n\n				<div class="form-group">        \n				   	<div class="col-sm-offset-2 col-sm-10 text-right">\n				    	<button ng-click="cancelNewAgent()" type="button" class="btn btn-danger" style="font-size: 13px !important">Cancelar</button>&nbsp;&nbsp;&nbsp;\n				    	<button type="submit" class="btn btn-primary" id="submit" ng-disabled="form.$invalid" style="font-size: 13px !important">Guardar</button>\n					</div>\n				</div>\n			</form>\n		</div>\n        \n		<div ng-if="error_new" id="" class="alert alert-danger" role="alert" style="">\n		  <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>\n		  <!-- <span class="sr-only">Error:({{result_new}})</span> -->\n		  <div>{{result_new}}</div>\n		</div>\n\n        <table class="table table-bordered" style="margin-top: 10px; background-color: white">\n        	<thead>\n        		<th>Run</th>\n        		<th>Nombre</th>\n        		<th>Email</th>\n        		<th>Teléfono</th>\n        		<th style="text-align: right">Acciones</th>\n        	</thead>\n        	<tbody>\n        		<tr dir-paginate="agent in agents | itemsPerPage: 10">\n	        		<td>{{ agent.RolUnico.numero }}-{{ agent.RolUnico.DV }}</td>\n	        		<td>{{ agent.name.nombres.join(" ") }}  {{ agent.name.apellidos.join(" ") }} </td>\n	        		<td>{{ agent.other_info.email }}</td>\n	        		<td ng-if="agent.other_info.phone">{{ agent.other_info.phone.code }} {{ agent.other_info.phone.number }}</td>\n	        		<td ng-if="!agent.other_info.phone">-</td>\n	        		<td style="text-align: right">\n	        			<button class="btn btn-danger" style="font-size: 13px; padding: 5px 20px" confirmed-click="deleteAgent(agent.RolUnico.numero)" ng-confirm-click="¿Estás seguro de eliminar el Agente?">Eliminar</button>\n	        		</td>\n	        	</tr>\n        	</tbody>\n        </table>\n\n        <nav class="text-center">\n          <dir-pagination-controls></dir-pagination-controls>\n        </nav>\n   	  </div>\n    </div>\n  </div>\n</section>'),a.put("views/institutional/charts.html",'<div class="container">\n  <div class="row">\n    <div class="chart col-md-12">\n      <dashboard-chart chart="1"></dashboard-chart>\n      <dashboard-chart chart="2"></dashboard-chart>\n    </div>\n  </div>\n</div>'),a.put("views/institutional/credentials.html",'<section id="how-it-works">\n  <div class="container">\n    <div class="pull-right">\n      <a ui-sref="institutional.credentials" class="btn btn-primary">Credenciales</a>\n      <a ui-sref="institutional.agentes" class="btn btn-primary">Mantenedor Agentes</a>\n    </div>\n\n    <h1>Credenciales</h1>\n    <div class="row">\n      <div class="col-md-12">\n        <div class="input-group col-lg-6 col-md-6 col-sm-12 col-xs-12" show-errors>\n          <input name="client_id" ng-model="client_id" required class="form-control ng-pristine ng-isolate-scope ng-empty ng-invalid" placeholder="Client ID" required style="margin-bottom: 10px">\n          <span class="input-group-btn">\n            <button promise-btn class="btn btn-primary" type="submit" id="submit" style="font-size: 12px !important; padding: 13px 12px 8px; margin-bottom: 10px">\n              <i class="glyphicon glyphicon-search"></i>\n            </button>\n          </span>\n        </div>\n\n\n        <table class="table table-bordered table-striped">\n          <thead>\n            <tr>\n              <th></th>\n              <th>client_id</th>\n              <th>client_secret</th>\n              <th>redirect_uri</th>\n              <th style="text-align: right">Options</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td><label class="btn_credentials" style="background-color: #ff9800">Stagging</label></td>\n              <td>123asd231213jkn31j2n31on123</td>\n              <td>n31j21231n31o213jkn1233asd2</td>\n              <td>domain.com/callback_test</td>\n              <td style="text-align: right">\n                <span class="">Ver</span>\n                &nbsp;|&nbsp;\n                <span class="">Editar</span>\n                &nbsp;|&nbsp;\n                <span class="">Eliminar</span>\n              </td>\n            </tr>\n            <tr>\n              <td><label class="btn_credentials" style="background-color: #03a9f4">Production</label></td>\n              <td>123asd231213jkn31j2n31on123</td>\n              <td>n31j21231n31o213jkn1233asd2</td>\n              <td>domain.com/callback</td>\n              <td style="text-align: right">\n                <span class="">Ver</span>\n                &nbsp;|&nbsp;\n                <span class="">Editar</span>\n                &nbsp;|&nbsp;\n                <span class="">Eliminar</span>\n              </td>\n            </tr>\n            <!-- <tr dir-paginate="credential in credentials | itemsPerPage: 10">\n              <td></td>\n              <td></td>\n              <td></td>\n            </tr>\n            <tr ng-show="!activities.length">\n              <td colspan="5" class="text-center"><h3>Cargando credenciales...</h3></td>\n            </tr> -->\n          </tbody>\n        </table>\n\n        <nav class="text-center">\n          <dir-pagination-controls></dir-pagination-controls>\n        </nav>\n\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/institutional/home.html",'<section id="home-institucional">\n  <div id="hero" class="container">\n    <div class="row">\n      <div class="col-md-12">\n        <div class="jumbotron">\n          <h1 style="font-family: \'Roboto Slab\'">Promueve el uso de Claveúnica en tu institución</h1>\n          <p><a class="btn btn-primary btn-lg hide" href="#" role="button">Solicita material de difusión</a></p>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div id="up-down" ng-controller="MetricsController">\n    <div class="container">\n      <div class="row">\n        <div class="col-md-4">\n          <div class="tarjeta text-center">\n            <h3>Estado del Servicio</h3>\n            <div id="status" ng-class="status" title="En Línea">En Línea</div>\n            <span ng-show="!data">Obteniendo estado...</span>\n            <div ng-switch="data.statusClaveUnica">\n              <span ng-switch-when="1">En línea</span>\n              <span ng-switch-when="2">Fuera de línea</span>\n              <span ng-switch-when="3">En mantenimiento</span>\n              <a href="https://status.claveunica.gob.cl/" target="_blank" style="color: #1e69b4; text-decoration: underline">ver más</a>\n            </div>\n          </div>\n        </div>\n        <div class="col-md-8" id="metrics">\n          <div class="tarjeta metrics_inst">\n            <h3 class="text-center">Actualmente contamos con</h3>\n            <div class="row">\n              <div class="col-md-4 col-sm-4 box-number">\n                <span class="number">{{ data.numberUsers | formatPrice }}</span>\n                <span class="description">Ciudadanos activos</span>\n              </div>\n              <div class="col-md-2 col-sm-2 box-number">\n                <span class="number">{{ data.numberInstitutions | formatPrice }}</span>\n                <span class="description">Instituciones</span>\n              </div>\n              <div class="col-md-3 col-sm-4 box-number">\n                <span class="number">{{ data.numberApps | formatPrice }}</span>\n                <span class="description">Trámites</span>\n              </div>\n              <div class="col-md-3 col-sm-4 box-number">\n                <span class="number">{{ data.numberTransactionsDay | formatPrice }}</span>\n                <span class="description">Autenticaciones hoy</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div id="opciones">\n    <div class="container">\n      <div class="row">\n        <div class="col-md-4">\n          <div class="tarjeta">\n            <h3><span class="glyphicon glyphicon-console"></span>¿Cómo funciona?</h3>\n            <p>Nos basamos en el estándar OpenID Connect para verificar la identidad en múltiples instituciones, utilizando una sola contraseña</p>\n            <a class="btn btn-primary pull-right" ui-sref="institutional.how">Quiero saber más</a>\n          </div>\n        </div>\n        <div class="col-md-4">\n          <div class="tarjeta">\n            <h3><span class="glyphicon glyphicon-check"></span>Solicitar activación</h3>\n            <p>Ingresa con tu ClaveÚnica, completa el formulario y te entregaremos los datos para que integres nuestro servicio en tu institución.</p>\n            <a class="btn btn-primary pull-right" ui-sref="institutional.request">Ir al formulario</a>\n          </div>\n        </div>\n        <div class="col-md-4">\n          <div class="tarjeta">\n            <h3><span class="glyphicon glyphicon-cog"></span>Guía técnica</h3>\n            <p>Una vez que tu institución cuente con las credenciales, sigue estas instrucciones para integrar ClaveÚnica.</p>\n            <a class="btn btn-primary pull-right" ui-sref="institutional.tutorial">Llévame a la guía</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/institutional/how-it-works.html",'<section id="how-it-works">\n  <div class="container">\n    <h1 style="font-family: \'Roboto Slab\'">¿Cómo funciona?</h1>\n    <!-- <h2>Funcionamiento General de OpenID Connect en ClaveÚnica</h2> -->\n    <div class="row">\n      <div class="col-md-8">\n        <h3>OpenID Connect</h3>\n        <p>OpenID Connect es un protocolo estándar que permite autenticar y/o autorizar identidades para obtener un recurso protegido.</p>\n        <p>Permite tres flujos para la autenticación, que dictan cómo es la interacción entre el consumidor y el proveedor del servicio.</p>\n        <p>En particular, ClaveÚnica implementa el flujo Authorization Code Flow, el cual permite mantener sesiones de acceso por períodos más largos y con mayores controles de seguridad.</p>\n        <br><br>\n        <h3>Flujo de Código de Autorización o Authorization Code Flow</h3>\n        <p>Para este mecanismo de autenticación, el servicio deberá obtener con ClaveÚnica un código de acceso, posterior a la identificación del usuario en Registro Civil, que puede ser cambiado por un token de acceso.</p>\n        <p>Este token permitirá obtener la autorización para acceder al usuario a un recurso protegido, y a su vez, que dicha aplicación sea autenticada en ClaveÚnica, por lo que el token de acceso es cambiado por un token de autorización lo que se traduce que tanto el usuario como tu servicio fueron autenticados y autorizados por el servicio de ClaveÚnica.</p>\n        <p>Este token permite mantener la sesión del usuario y de la aplicación, ambos identificados por el servicio de ClaveÚnica.</p>\n        <p>Sin embargo, el token de autorización tiene un tiempo de expiración, que puede ser extendido siempre y cuando la aplicación envíe solicitudes usando un <i>token de refresco</i> (sin la necesidad de volver hacer el proceso de autenticación)</p>\n        <p>El siguiente diagrama de secuencia se resume el proceso de autenticación y autorización de ClaveÚnica</p>\n        <br><br>\n        <img class="img-responsive center-block" src="/images/flujo-oidc.a0e6a038.png" alt="Diagrama de secuencia">\n      </div>\n      <div class="col-md-4 hidden-xs hidden-sm" style="margin-top: 50px">\n        <ng-include src="\'views/institutional/sidebar.html\'"></ng-include>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/institutional/index.html","<ui-view></ui-view>"),a.put("views/institutional/request.html",'<section id="request">\n  <div class="container">\n    <h1>Solicitar activación</h1>\n    <div class="row">\n      <div class="col-md-8">\n        <form name="form" class="clearfix" novalidate>\n          <h3>¿Quién solicita?</h3>\n          <div class="form-group" show-errors>\n            <input name="institution" type="text" class="form-control" placeholder="Institución o empresa*" ng-model="request.institution" required>\n            <p ng-messages="form.institution.$error" class="text-danger" ng-if="form.institution.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n            </p>\n          </div>\n\n          <h3>Contacto técnico</h3>\n          <div class="form-group" show-errors>\n            <input name="nct" type="text" class="form-control" placeholder="Nombres y apellidos*" ng-model="request.nameContactTec" required>\n            <p ng-messages="form.nct.$error" class="text-danger" ng-if="form.nct.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input name="ect" type="email" class="form-control" placeholder="Correo electrónico*" ng-model="request.emailContactTec" required>\n            <p ng-messages="form.ect.$error" class="text-danger" ng-if="form.ect.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n              <span ng-message="email">El correo electrónico no es válido</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input name="pct" type="tel" class="form-control" placeholder="Teléfono* (Ej. +56912345678)" ng-model="request.phoneContactTec" ng-pattern="regex" required>\n            <p ng-messages="form.pct.$error" class="text-danger" ng-if="form.pct.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n              <span ng-message="pattern">El número telefónico no es válido</span>\n            </p>\n          </div>\n\n          <h3>Contacto administrativo</h3>\n          <div class="form-group" show-errors>\n            <input name="nca" type="text" class="form-control" placeholder="Nombres y apellidos*" ng-model="request.nameContactAdm" required>\n            <p ng-messages="form.nca.$error" class="text-danger" ng-if="form.nca.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input name="eca" type="email" class="form-control" placeholder="Correo electrónico*" ng-model="request.emailContactAdm" required>\n            <p ng-messages="form.eca.$error" class="text-danger" ng-if="form.eca.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n              <span ng-message="email">El correo electrónico no es válido</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input name="pca" type="tel" class="form-control" placeholder="Teléfono* (Ej. +56912345678)" ng-model="request.phoneContactAdm" ng-pattern="regex" required>\n            <p ng-messages="form.pca.$error" class="text-danger" ng-if="form.pca.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n              <span ng-message="pattern">El número telefónico no es válido</span>\n            </p>\n          </div>\n\n          <h3>Descripción del servicio a integrar</h3>\n          <div class="form-group" show-errors>\n            <textarea name="desc" class="form-control" rows="3" ng-model="request.descriptionApp" required></textarea>\n            <p ng-messages="form.desc.$error" class="text-danger" ng-if="form.desc.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input name="name" class="form-control" ng-model="request.nameApp" required placeholder="Nombre de la aplicación*">\n            <p ng-messages="form.name.$error" class="text-danger" ng-if="form.name.$touched">\n              <span ng-message="required">Este campo es obligatorio</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input name="proc" type="url" class="form-control" placeholder="(Opcional) Ejemplo: http://plagas.minagri.cl/tramites" ng-model="request.procedureUrl">\n            <p>URL de la página donde se dispondrá el botón de Claveúnica para realizar el trámite (opcional)</p>\n            <p ng-messages="form.proc.$error" class="text-danger" ng-if="form.proc.$touched">\n              <span ng-message="url">La URL no es válida</span>\n            </p>\n          </div>\n\n          <h3>URI\'s de redirección</h3>\n          <div class="form-group" show-errors>\n            <input name="prod" type="url" class="form-control" placeholder="Producción (Ejemplo: https://plagas.minagri.gob.cl/callback/claveunica)" ng-model="request.urlProd">\n            <p>La uri de producción debe estar bajo <b>https</b> y terminar con un <i>callback</i>, por ejemplo <b>https://dominio.com/claveunica</b></p>\n            <p ng-messages="form.prod.$error" class="text-danger" ng-if="form.prod.$touched">\n              <span ng-message="url">La URL de Producción no es válida</span>\n            </p>\n          </div>\n\n          <div class="form-group" show-errors>\n            <input name="qa" type="url" class="form-control" placeholder="Test/QA: * (Ejemplo: https://testing-plagas.minagri.gob.cl/callback/claveunica)*" ng-model="request.urlSandbox" required>\n            <p ng-messages="form.qa.$error" class="text-danger" ng-if="form.qa.$touched">\n              <span ng-message="url">La URL de Test no es válida</span>\n            </p>\n          </div>\n\n          <div class="form-group">\n            <h4>Paso a Producción</h4>\n            <p>Luego de presionar el botón activar, las credenciales de Testing quedarán operativas inmediatamente.</p>\n            <p>Para habilitar las credenciales de producción deberás cumplir los siguientes requisitos:</p>\n            <ul>\n              <li>La implementación productiva debe estar bajo <b>https</b>.</li>\n              <li>Se debe utilizar el <a href="https://git.gob.cl/claveunica/ejemplos/raw/master/Pack%20Botones.zip">botón</a> y texto de Claveúnica.</li>\n            </ul>\n            <p>Si cuentas con esto, debes contactarte con nosotros mediante este <a href="http://claveunica.soporte.digital.gob.cl/support/home" taget="_blank">link</a> indicando el <b>client_id</b> de las credenciales de producción y luego de validar activaremos las credenciales para la utilización de run de ciudadanos.</p>\n            <hr>\n            <h4>Condiciones de uso</h4>\n            <p>El servicio de ClaveÚnica sólo se debe utilizar como mecanismo de validación de identidad de los ciudadanos para el acceso a servicios puestos a su disposición.</p>\n            <p>Cumplir con las obligaciones de protección a la vida privada, en especial con las disposiciones contenidas en la Ley N° 19.628 sobre Protección de la Vida Privada.</p>\n            <p>Utilizar los dispositivos que sean necesarios para que la información que ingresan y/o que acceden las personas en los sistemas de tramitación electrónica se realice de forma segura.</p>\n            <hr>\n            <p>En caso de realizar alguna actualización ó modificación de la información registrada deberá contactarse con nosotros mediante este <a href="http://claveunica.soporte.digital.gob.cl/support/home" taget="_blank">link</a> indicando el <b>client_id</b> de las credenciales de producción indicando la información que desea cambiar; asi mismo podrá escribirnos para aclarar cualquier tipo de dudas.</p>\n            <p>Actualmente no existe un limite de las solicitudes de activación por cliente.</p>\n            <p>Nota: Los usuarios solo tienen cinco (5) intentos de logueo correcto, en caso contrario deberá esperar una (01) hora para volver a ingresar ó deberá recuperar su ClaveÚnica.</p>\n          </div>\n\n          <div class="form-group checkbox">\n            <label>\n              <input name="confirm" type="checkbox" ng-model="confirm" required> Acepto las condiciones de uso*\n            </label>\n            <div ng-messages="form.confirm.$error" ng-if="form.confirm.$dirty" class="text-danger">\n              <p ng-message="required">Debes aceptar las condiciones de uso</p>\n            </div>\n          </div>\n        </form>\n\n        <div class="row">\n          <div class="col-md-12">\n            <div ng-if="error" class="alert alert-danger" style="margin-top: 5px">\n              {{ error }}\n            </div>\n          </div>\n        </div>\n\n        <button promise-btn class="btn btn-primary pull-right" ng-disabled="form.$invalid" ng-click="submit(form)">Activar</button>\n      </div>\n\n      <div class="col-md-4 hidden-xs hidden-sm">\n        <ng-include src="\'views/institutional/sidebar.html\'"></ng-include>\n      </div>\n\n      <script type="text/ng-template" id="credentialsModal.html">\n        <div class="modal-header">\n          <h3 class="modal-title">Credenciales de aplicación</h3>\n        </div>\n\n        <div class="modal-body">\n          <div ng-show="data.credentials.appProd.client_id && data.credentials.appProd.client_secret">\n            <h4>Credenciales producción</h4>\n\n            <table class="table table-condensed borderless">\n              <tbody>\n              <tr><th>Client ID:</th><td><pre>{{ data.credentials.appProd.client_id }}</pre></td></tr>\n              <tr><th>Client secret:</th><td><pre>{{ data.credentials.appProd.client_secret }}</pre></td></tr>\n              </tbody>\n            </table>\n          </div>\n\n          <div ng-show="data.credentials.appSandbox.client_id && data.credentials.appSandbox.client_secret">\n            <h4>Credenciales sandbox</h4>\n            <table class="table table-condensed borderless">\n              <tbody>\n              <tr><th>Client ID:</th><td><pre>{{ data.credentials.appSandbox.client_id }}</pre></td></tr>\n              <tr><th>Client secret:</th><td><pre>{{ data.credentials.appSandbox.client_secret }}</pre></td></tr>\n              </tbody>\n            </table>\n          </div>\n\n          <h4>Tickets de soporte</h4>\n          <p>Puede solicitar soporte en <a href="https://soporte.digital.gob.cl/open.php?topicId=12" target="_blank">aqu&iacute;</a> indicando alguno de los siguientes identificadores en los detalles del problema:</p>\n          <table class="table table-condensed borderless">\n            <tbody>\n            <tr ng-show="data.ticketsId.appProduction">\n              <th>Producción</th>\n              <td><pre>{{ data.ticketsId.appProduction }}</pre></td>\n            </tr>\n\n            <tr ng-show="data.ticketsId.appSandbox">\n              <th>Sandbox</th>\n              <td><pre>{{ data.ticketsId.appSandbox }}</pre></td>\n            </tr>\n            </tbody>\n          </table>\n        </div>\n\n        <div class="modal-footer">\n          <a class="btn btn-sm btn-success pull-left" ng-click="downloadFile()" ng-href="{{ url }}">Descargar <i class="glyphicon glyphicon-download-alt"></i></a>\n          <button class="btn btn-sm btn-primary pull-right" ng-click="dismissModal()">Aceptar</button>\n        </div>\n\n\n      </script>\n    </div>\n  </div>\n</section>'),
a.put("views/institutional/sidebar.html",'<aside id="libraries">\n  <h4>Kit de Implementación</h4>\n  <p style="margin-top: 14px">En nuestro GIT puedes descargar ejemplos de integraciones implementadas en distintos lenguajes de programación</p>\n  <ul>\n    <li><a href="https://git.gob.cl/claveunica/ejemplos/tree/master/PHP" target="_blank" title="Php"><span class="glyphicon glyphicon-console"></span> Php</a></li>\n  </ul>\n  <ul>\n    <li><a href="https://git.gob.cl/claveunica/ejemplos/tree/master/JAVA" target="_blank" title="Java"><span class="glyphicon glyphicon-console"></span> Java</a></li>\n  </ul>\n  <ul>\n    <li><a href="https://git.gob.cl/claveunica/ejemplos/tree/master/dotNET" target="_blank" title=".Net"><span class="glyphicon glyphicon-console"></span> .Net</a></li>\n  </ul>\n</aside>'),a.put("views/institutional/soporte.html",'<section id="how-it-works">\n  <div class="container">\n    <div class="pull-right">\n      <!-- <a ng-if="isAdmin === true" ui-sref="institutional.credentials" class="btn btn-primary">Credenciales</a> -->\n      <a ng-if="isAdmin === true" ui-sref="institutional.agentes" class="btn btn-primary">Mantenedor Agentes</a>\n    </div>\n    <h1>Soporte Ciudadanos</h1>\n    <div class="row">\n      <div class="col-md-12">\n        <form id="form_search_citizen" ng-submit="submit()" ng-controller="SoporteController" class="clearfix">\n          <div class="input-group" show-errors>\n          <input name="run" ng-model="run" ng-model="request.institution" required class="form-control ng-pristine ng-isolate-scope ng-empty ng-invalid ng-invalid-validate-rut ng-invalid-required ng-touched" placeholder="Run del Ciudadano (Ej. 11222333-4)" validate-rut="" required>\n          <span class="input-group-btn">\n            <button promise-btn class="btn btn-primary" type="submit" id="submit" ng-disabled="form.$invalid" style="font-size: 12px !important">\n              <i class="glyphicon glyphicon-search"></i>\n            </button>\n          </span>\n        </div>\n        <p ng-messages="form.run.$error" class="text-danger" ng-if="form.run.$touched">\n        <span ng-message="required">Este campo es obligatorio</span>\n      </p>\n\n\n    <div ng-show="error != \'\'" id="error-usuario-no-existe" class="alert alert-danger" role="alert" style="margin-top: 15px !important">\n      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>\n      <span class="sr-only">Error:</span>\n      <p ng-bind-html="error"></p>\n    </div>\n\n    <div class="jumbotron" ng-show="result == \'resultado\'">\n      <h1><b ng-bind="ciudadano_nombre"></b></h1>\n      <p>\n        </p><p>RUN: <b ng-bind="ciudadano_run"></b></p>\n\n        <hr>\n        <p><b>Datos de Contacto</b></p>\n        <p>Teléfono: <b ng-bind="ciudadano_telefono"></b></p>\n        <p>Email: <b ng-bind="ciudadano_email"></b>\n          <input ng-if="institucion != \'\'" type="button" class="btn-warning" id="btn_editar_email" value="editar" ng-click="showEditEmail()">\n          <br>\n          <input type="text" class="form-control" ng-model="email_new" name="email_new" id="email_new" style="display: none; margin-bottom: 5px; width: 350px !important">\n          <input type="button" class="btn-primary" id="btn_cancelar_guardar_email" value="Cancelar" ng-click="cancelNewEmail()" style="display: none">\n          <input type="button" class="btn-danger" id="btn_guardar_email" value="Guardar" ng-click="saveNewEmail(ciudadano_run)" style="display: none">\n        </p>\n\n        <hr>\n        <!-- <p><b>Enrolamiento y Activación</b></p> -->\n        <p><b>Ciudadano <span ng-bind="ciudadano_estado"></span></b></p>\n        <p ng-if="ciudadano_enrolamiento">Fecha / Hora Último Enrolamiento: <b ng-bind="ciudadano_enrolamiento"></b></p>\n        <p ng-if="ciudadano_activacion">Fecha / Hora Última Activación: <b ng-bind="ciudadano_activacion"></b></p>\n\n        <hr>\n        <p><b>Estado</b></p>\n        <p>Bloqueado: <b ng-bind="ciudadano_bloqueado"></b></p>\n        <p>Intentos Fallidos: <b ng-bind="ciudadano_intentos"></b></p>\n        <p>Fecha / Hora Intento Fallido: <b ng-bind="ciudadano_intentos_fecha"></b></p>\n      \n      <hr>\n      <div class="clearfix">\n        <div class="pull-left">\n          <a href="#" class="btn btn-info btn-lg" style="margin-top: 31px" ng-click="limpiarForm()" role="button">Limpiar</a>\n        </div>\n        <div class="pull-right">\n          <label ng-if="ciudadano_email" class="radio-inline"><input type="radio" ng-model="request.optradio" ng-value="1">EMAIL</label>\n          <label ng-if="ciudadano_telefono" class="radio-inline"><input type="radio" ng-model="request.optradio" ng-value="2">SMS</label>\n          <br>\n          <button ng-disabled="!request.optradio" ng-click="sendRecoveryBySupport(request.optradio)" class="btn btn-primary btn-lg" style="margin-top: 10px" role="button">Enviar nuevo código de activación</button>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="message" class="alert alert-info" role="alert" style="margin-top: 15px !important">\n      <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>\n      <span class="sr-only">Información:</span>\n      <p ng-bind-html="message"></p>\n    </div>\n\n    <div class="jumbotron" style="text-align: right; text-decoration: underline">\n      <a href="http://claveunica.soporte.digital.gob.cl/" target="_blank">CONTACTAR ADMINISTRADOR DE LA PLATAFORMA</a>\n    </div>\n</form>\n      </div>\n    </div>\n  </div>\n</section>'),a.put("views/institutional/step_1.html",'<h4>Paso 1</h4>\n<h3>Crear Token de estado anti-falsificación</h3>\n<p>Debes proteger la seguridad de tus ciudadanos mediante la prevención de los ataques de falsificación de petición. El primer paso es crear un token de sesión único, que mantiene el estado entre tu aplicación y el ciudadano.</p>\n<p>Posteriormente debes hacer coincidir este token de sesión único con la respuesta de autenticación devuelto por el servicio de ClaveÚnica. Así, tanto ClaveÚnica como tu servicio, pueden asegurar que el usuario está haciendo la solicitud y no se trata de un atacante malicioso. Este tipo de ataque se denomina por  <a href="https://es.wikipedia.org/wiki/Cross-site_request_forgery" target="_blank">Cross-Site Request Forgery (CSRF)</a>.</p>\n<p>Una buena opción para un identificador de estado es una cadena de 30 o más caracteres construido con un <strong>generador de números aleatorios o generar un hash por medio de un secreto.</strong></p>'),a.put("views/institutional/step_2.html",'<h4>Paso 2</h4>\n<h3>Enviar una solicitud de autenticación al servicio de ClaveÚnica</h3>\n\n<p>El siguiente paso es formar una solicitud <b>GET</b> vía <b>HTTPS</b> con los parámetros adecuados en la <b>URI</b>. Debes usar en todo el momento el protocolo <b>HTTPS</b>. El protocolo <b>HTTP</b> no está permitido, debido a que la información viaja en texto plano.</p>\n<p>La <strong>URI</strong> donde debe ser enviada la solicitud <strong>GET</strong> es:</p>\n\n<code><strong>https://accounts.claveunica.gob.cl/openid/authorize/</strong></code>\n\n<p>Los parámetros que deben ser enviados en la <strong>URI</strong> son:</p>\n\n<code>\n  <ul class="clave">\n    <li><strong>client_id:</strong> Este parámetro se obtiene al <a href="https://claveunica.gob.cl/institucional/solicitud-activacion">Activar la Institución</a>.</li>\n    <li><strong>response_type:</strong> Este parámetro es parte de la lógica utilizada por OpenID Connect y siempre debe ser <b>code</b>.</li>\n    <li><strong>scope:</strong> Este parámetro permite obtener la información del ciudadano (run y nombre completo) y debe ser <b>openid run name email</b>.</li>\n    <li><strong>redirect_uri:</strong> En este parámetro debe ir la URI (<b>codificada en formato URL</b>) de tu aplicación que interactuará con Claveúnica. Esta recibirá la respuesta por parte de Claveúnica.\n.</li>\n    <li><strong>state:</strong> En este parámetro debe ir un Token único de sesión (revisar paso 1).</li>\n  </ul>\n</code>\n\n<p>Parámetros de Ejemplo:</p>\n<code>\n  <ul class="clave">\n    <li><strong>client_id:</strong> 123</li>\n    <li><strong>response_type:</strong> code</li>\n    <li><strong>scope:</strong> openid run name</li>\n    <li><strong>redirect_uri:</strong> https://example.com (debe ir encodeada)</li>\n    <li><strong>state:</strong> abcdefgh</li>\n    <li><strong>URI:</strong> https://accounts.claveunica.gob.cl/openid/authorize?client_id=123&amp;redirect_uri=https%3A%2F%2Fexample.com&amp;response_type=code&amp;scope=openid run name&amp;state=abcdefgh</li>\n  </ul>\n</code>\n<p>Credenciales para Testing (Sandbox):</p>\n<code>\n<ul>\n  <li>RUN: 44.444.444-4, contraseña: "testing"</li>\n  <li>RUN: 55.555.555-5, contraseña: "testing"</li>\n  <li>RUN: 88.888.888-8, contraseña: "testing"</li>\n  <li>RUN: 99.999.999-9, contraseña: "testing"</li>\n\n</ul>\n</code>'),a.put("views/institutional/step_3.html",'<h4>Paso 3</h4>\n<h3>Confirmar el Token de estado de anti-falsificación</h3>\n<div class="description">\n  <p>La respuesta que se obtiene del <b>Paso 2</b> es enviada a la URI de Redirección indicada como <b>redirect_uri</b>. Continuando con el ejemplo, lo obtenido sería algo así</p>\n\n  <code><strong><em>https://example.com/?code=5fb3b172913448acadce6b011af1e75e&amp;state=abcdefgh</em></strong></code>\n\n  <p>En tu aplicación, debes corroborar que el <b>state</b> que se recibió de Claveúnica coincide con el <b>token</b> de sesión creado en el <b>Paso 1</b>. Esta verificación de <i>ida y vuelta</i> ayuda a garantizar que es un ciudadano y no un atacante que está haciendo la solicitud.</p>\n</div>'),a.put("views/institutional/step_4.html","<h4>Paso 4</h4>\n<h3>Cambiar el código de activación por Token de acceso y un Token de autorización</h3>\n\n<p>La respuesta incluye un parámetro llamado <strong>code</strong>. Este es un código de acceso único que tiene un tiempo de expiración de 5 minutos.\n  Con este codigo tu aplicación puede solicitar un <strong>Token de acceso</strong>.\n</p>\n\n<p>Para solicitar este <strong>Token de acceso</strong> debe enviar una solicitud <strong>POST via HTTPS</strong>.</p>\n<p>La <strong>URI</strong> donde debe ser enviada la solicitud POST es:</p>\n\n<code><strong><em>https://accounts.claveunica.gob.cl/openid/token/</em></strong></code>\n\n<p>Los parámetros que deben ser enviados en el cuerpo del mensaje POST son:</p>\n\n<code>\n  <ul class=\"clave\">\n    <li><strong>client_id:</strong> Este parámetro se obtiene al <a href=\"https://claveunica.gob.cl/institucional/solicitud-activacion\">Activar la Institución</a>.</li>\n    <li><strong>client_secret:</strong> Este parámetro se obtiene al <a href=\"https://claveunica.gob.cl/institucional/solicitud-activacion\">Activar la Institución</a></li>\n    <li><strong>redirect_uri:</strong> En este parámetro debe ir la URI de tu aplicación (la misma del Paso 2).</li>\n    <li><strong>grant_type:</strong> Este parámetro es parte de la lógica utilizada por OpenID Connect y siempre debe ser <b>authorization_code</b>.</li>\n    <li><strong>code:</strong> En este parámetro debe ir el código de acceso obtenido en el Paso 3.</li>\n    <li><strong>state:</strong> En este parámetro debe ir el mismo Token único de sesión que fue indicado en el <strong><em>Paso 1</em></strong>.</li>\n  </ul>\n</code>\n\n<p>Continuando con el ejemplo iniciado en el <b>Paso 2</b>, la URI que se debe enviar vía <b>POST</b> seria:</p>\n\n<code>\n<em>\n  <strong>POST /openid/token/ HTTPS/2</strong><br>\n  <strong>Host: https://www.claveunica.gob.cl</strong><br>\n  <strong>Content-Type: application/x-www-form-urlencoded</strong><br>\n\n  code=5fb3b172913448acadce6b011af1e75e\n  client_id=123&amp;\n  client_secret=456&amp;\n  redirect_uri=https://example.com/&amp;\n  grant_type=authorization_code&amp;\n  state=asdfgh\n</em>\n</code>\n\n<p><b>Ejemplo curl</b></p>\n<code>\n  curl -i 'https://accounts.claveunica.gob.cl/openid/token/'\n  -H 'content-type: application/x-www-form-urlencoded; charset=UTF-8'\n  --data 'client_id=CLIENT_ID&amp;\n  client_secret=CLIENT_SECRET&amp;\n  redirect_uri=URI_REDIRECT_ENCODEADA&amp;\n  grant_type=authorization_code&amp;\n  code=CODE&amp;\n  state=STATE'\n</code>"),a.put("views/institutional/step_5.html",'<h4>Paso 5</h4>\n<h3>Autenticar usuario</h3>\n\n<p>La respuesta obtenida en el paso anterior es un <strong>JSON</strong>, de este se requiere el parámetro llamado <strong>access token (Token de acceso)</strong>.</p>\n<p>JSON ejemplo.</p>\n\n<pre><strong>{\n    "access_token": "95104ab471534af08683aefa7d0935a3",\n    "token_type": "bearer",\n    "expires_in": 3600,\n    "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6Ijg1ZGVjMDU1MjZmNjUwZGIxYWMyYWFlMTI4NTc3NGM3In0"\n}</strong>\n</pre>\n\n<p>Hasta este paso tu aplicación está apta para decir al ciudadano si su autenticación en ClaveÚnica está correcta o no.</p>\n\n<p>El <strong><em> Paso 6</em></strong>, sirve para que tu aplicación pueda obtener información adicional sobre el ciudadano dependiendo el parámetro scope enviado.</p>'),a.put("views/institutional/step_6.html",'<h4>Paso 6</h4>\n<h3>Obtener información de ciudadano por medio del Token de autorización</h3>\n<p>En este paso te explicaremos como puedes obtener información del ciudadano dependiendo el <strong>scope</strong>.</p>\n<p><strong><em>Nota: Cabe mencionar que no todos pueden enviar cualquier scope, este es acordado en la solicitud de ClaveÚnica.</em></strong></p>\n<p>En el <strong><em>Paso 5</em></strong> el ciudadano ya está autenticado, pero un módulo de tu aplicación puede obtener información adicional sobre los ciudadanos, como por ejemplo Nombre y/o RUN.</p>\n<p>Para lograr esto, se requiere enviar una solicitud POST con el Token de acceso obtenido anteriormente.</p>\n<p>La solicitud POST se envía de la siguiente forma:</p>\n<code><strong><em>POST /openid/userinfo/ HTTPS/1.1<br>\nHost: https://www.claveunica.gob.cl<br>\nAuthorization: Bearer [ACCESS_TOKEN]</em></strong></code>\n<p>Donde Authorization: es una cabecera.</p>\n<p>Con esta solicitud tu aplicación recibirá un JSON de este estilo (dependiendo qué scope tenga asignada)</p>\n<code><strong>\n{\n    "sub": "2",\n    "RolUnico": {\n        "numero": 55555555,\n        "DV": "5",\n        "tipo": "RUN"\n    },\n    "name": {\n'+"        \"nombres\": ['Maria', 'Carmen', 'De', 'Los', 'Angeles'],\n        \"apellidos\": ['Del', ' Rio', 'Gonzalez']\n    }\n}\n</strong></code>\n<p><strong>Recomendación de seguridad para este paso:</strong></p>\n<p>Normalmente, es fundamental validar los <strong>Token</strong> , aunque en este caso particular, esto no es algo necesario debido a que se está comunicando con ClaveÚnica por medio de un canal <strong>HTTPS</strong>. Además, se realizó un intercambio de credenciales mediante el <strong>Cliend ID</strong>, <strong>Client Secret</strong> y un <strong>Token de estado</strong>, por lo que tu aplicación debe tener la certeza de que el ciudadano está correctamente autenticado.</p>\n<p>En caso de que tu aplicación intercambie el Token de autorización a otros componentes fuera del flujo de tu aplicación, es recomendable que este componente valide dicho Token.\n  La mayor parte de las API combinan la validación con el trabajo de descifrar el <strong>base64</strong> y parsear el <strong>JSON</strong>, por lo que probablemente terminarás por validar el token.\n</p>\n\n<p><b>Ejemplo curl</b></p>\n<code>\ncurl -i 'https://www.claveunica.gob.cl/openid/userinfo/' -X POST -H 'authorization: Bearer TOKEN'\n</code>\n\n\n<h3>Paso a Producción</h3>\n<p>Para habilitar las credenciales de producción deberás cumplir los siguientes requisitos:</p>\n<ul>\n    <li>La implementación productiva debe estar bajo <b>https</b>.</li>\n    <li>Se debe utilizar el <a href=\"https://git.gob.cl/claveunica/ejemplos/raw/master/Pack%20Botones.zip\">botón</a> y texto de Claveúnica.</li>\n</ul>\n<p>Si cumples con los requisito y estás listo para pasar a producción, <a href=\"http://claveunica.soporte.digital.gob.cl/support/home\" target=\"_blank\">crea un nuevo ticket en nuestra mesa de ayuda</a> indicando el nombre de la institución y el Client ID de producción para que activemos tus credenciales.</p>\n<p>También puedes contactarnos a través del mismo medio si necesitas ayuda extra para integrar ClaveÚnica en tu sitio o aplicación.</p>\n\n<a class=\"btn btn-primary text-center btn-xl-soport\" href=\"http://claveunica.soporte.digital.gob.cl/support/home\" target=\"_blank\">Envíanos tu consulta o solicitud de activación en producción</a>"),a.put("views/institutional/tutorial.html",'<section id="tutorial">\n  <div class="container">\n    <h1 style="font-family: \'Roboto Slab\'">Guía técnica</h1>\n    <h2>Configura ClaveÚnica en tu servicio</h2>\n    <p id="manual_instalacion">Luego de que ya tienes el Cliente ID y Secret ID y nosotros tu URI de Redirección, ya estarás listo para montar tu servicio con ClaveÚnica.<br>El flujo soportado por ClaveÚnica es Authorization code Flow por lo que explicaremos el proceso de configuración en estos 6 pasos:</p>\n    <br>\n    <br>\n    <div class="row">\n      <div class="col-md-12 visible-xs-block visible-sm-block">\n        <form id="step-filter" class="form-inline">\n          <div class="form-group">\n            <select class="form-control" ng-change="changeStep(selected)" ng-model="selected" ng-options="steps.indexOf(selected) as selected for selected in steps">\n            </select>\n          </div>\n        </form>\n      </div>\n    </div>\n\n    <div class="row">\n      <div class="col-md-12 visible-xs-block visible-sm-block">\n        <ng-include src="\'views/institutional/step_1.html\'" ng-if="selected == 0"></ng-include>\n        <ng-include src="\'views/institutional/step_2.html\'" ng-if="selected == 1"></ng-include>\n        <ng-include src="\'views/institutional/step_3.html\'" ng-if="selected == 2"></ng-include>\n        <ng-include src="\'views/institutional/step_4.html\'" ng-if="selected == 3"></ng-include>\n        <ng-include src="\'views/institutional/step_5.html\'" ng-if="selected == 4"></ng-include>\n        <ng-include src="\'views/institutional/step_6.html\'" ng-if="selected == 5"></ng-include>\n      </div>\n    </div>\n\n    <div class="hidden-xs">\n      <uib-tabset>\n        <div class="col-md-2 hidden-sm hidden-xs nopadding">\n          <uib-tab>\n            <uib-tab-heading><strong>Paso 1</strong> <br>Crear Token de estado anti-falsificación</uib-tab-heading>\n            <ng-include src="\'views/institutional/step_1.html\'"></ng-include>\n          </uib-tab>\n        </div>\n        <div class="col-md-2 hidden-sm hidden-xs nopadding">\n          <uib-tab>\n            <uib-tab-heading><strong>Paso 2</strong> <br> Enviar una solicitud de autenticación al servicio de ClaveÚnica</uib-tab-heading>\n            <ng-include src="\'views/institutional/step_2.html\'"></ng-include>\n          </uib-tab>\n        </div>\n\n          <div class="col-md-2 hidden-sm hidden-xs nopadding">\n          <uib-tab>\n            <uib-tab-heading><strong>Paso 3</strong><br>Confirmar el Token de estado de anti-falsificación</uib-tab-heading>\n            <ng-include src="\'views/institutional/step_3.html\'"></ng-include>\n          </uib-tab>\n        </div>\n\n          <div class="col-md-2 hidden-sm hidden-xs nopadding">\n          <uib-tab>\n            <uib-tab-heading><strong>Paso 4</strong><br>Cambiar el código de acceso por los Token de Acceso y autorización</uib-tab-heading>\n            <ng-include src="\'views/institutional/step_4.html\'"></ng-include>\n          </uib-tab>\n        </div>\n\n          <div class="col-md-2 hidden-sm hidden-xs nopadding">\n          <uib-tab>\n            <uib-tab-heading><strong>Paso 5</strong> <br>Autenticar Usuario</uib-tab-heading>\n            <ng-include src="\'views/institutional/step_5.html\'"></ng-include>\n          </uib-tab>\n        </div>\n        <div class="col-md-2 hidden-sm hidden-xs nopadding">\n          <uib-tab>\n            <uib-tab-heading><strong>Paso 6</strong> <br>Obtener información de ciudadano y Paso a Producción</uib-tab-heading>\n            <ng-include src="\'views/institutional/step_6.html\'"></ng-include>\n          </uib-tab>\n        </div>\n      </uib-tabset>\n    </div>\n  </div>\n</section>')}]);